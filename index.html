<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tarawih Schema â€” Ramadan 2026</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;600;700&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet" />
  <style>
    :root {
      --primary: #24645d;
      --primary-dark: #1a4a44;
      --gold: #c9a84c;
      --gold-light: #e8c97a;
      --cream: #f7f4ef;
      --white: #ffffff;
      --text: #1a1a1a;
      --muted: #6b7280;
      --today-bg: #e8f7f0;
      --today-green: #3dba7e;
      --abdurrahman: #e8630a;
      --saed: #d4a800;
      --noor: #2980b9;
      --abdul: #2c2c2c;
      --mohammed: #219150;
      --yacquub: #7d3aac;
      --abdelsalam: #7b3f00;
      --hatem: #2d6a4f;
      --ibrahim: #1a6b8a;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { background: var(--cream); font-family: 'DM Sans', sans-serif; color: var(--text); -webkit-text-size-adjust: 100%; }

    /* HEADER */
    header { background: var(--primary); padding: 28px 20px 22px; text-align: center; position: relative; overflow: hidden; }
    header::before { content: ''; position: absolute; inset: 0; background: radial-gradient(ellipse at 15% 60%, rgba(201,168,76,0.14) 0%, transparent 55%); }
    .ornament { display: flex; align-items: center; justify-content: center; gap: 12px; margin-bottom: 20px; position: relative; z-index: 2; }
    .orn-line { height: 1px; width: 50px; }
    .orn-line.l { background: linear-gradient(to right, transparent, var(--gold)); }
    .orn-line.r { background: linear-gradient(to left, transparent, var(--gold)); }
    .orn-diamond { width: 7px; height: 7px; background: var(--gold); transform: rotate(45deg); }
    .orn-dot { width: 3px; height: 3px; background: var(--gold-light); border-radius: 50%; }
    header h1 { font-family: 'Cormorant Garamond', serif; font-size: clamp(1.8rem, 6vw, 3.2rem); font-weight: 600; color: var(--white); letter-spacing: .03em; line-height: 1.2; position: relative; z-index: 2; }
    .header-address { margin-top: 20px; position: relative; z-index: 2; display: flex; flex-direction: column; align-items: center; gap: 10px; }
    .header-address .addr-text { display: flex; align-items: center; gap: 6px; color: rgba(255,255,255,.65); font-size: .82rem; }
    .header-address a { display: inline-flex; align-items: center; gap: 6px; background: #fff; color: var(--primary-dark); font-size: .75rem; font-weight: 600; letter-spacing: .08em; text-transform: uppercase; padding: 7px 18px; border-radius: 30px; text-decoration: none; box-shadow: 0 2px 12px rgba(0,0,0,.15); }
    .wave { background: var(--primary); line-height: 0; }
    .wave svg { display: block; width: 100%; }

    /* MAIN */
    main { max-width: 960px; margin: 0 auto; padding: 32px 14px 80px; }

    /* TODAY CARD */
    .today-card { display: none; background: var(--white); border-radius: 20px; box-shadow: 0 8px 32px rgba(36,100,93,.14); overflow: hidden; margin-bottom: 28px; }
    .today-card-top { background: linear-gradient(135deg, var(--primary-dark), var(--primary)); padding: 20px 20px 16px; display: flex; align-items: center; gap: 14px; }
    .today-avatar { width: 52px; height: 52px; border-radius: 50%; background: rgba(255,255,255,.18); display: flex; align-items: center; justify-content: center; font-family: 'Cormorant Garamond', serif; font-size: 1.5rem; font-weight: 700; color: #fff; flex-shrink: 0; border: 2px solid rgba(255,255,255,.25); }
    .today-card-info { flex: 1; }
    .today-card-label { font-size: .65rem; letter-spacing: .16em; text-transform: uppercase; color: rgba(255,255,255,.55); display: block; margin-bottom: 3px; }
    .today-card-name { font-family: 'Cormorant Garamond', serif; font-size: 1.5rem; font-weight: 600; color: #fff; line-height: 1.1; display: block; }
    .today-card-date { font-size: .78rem; color: rgba(255,255,255,.5); display: block; margin-top: 2px; }
    .today-card-bottom { padding: 14px 20px; display: flex; align-items: flex-start; justify-content: space-between; gap: 12px; flex-wrap: wrap; }
    .today-bottom-left { display: flex; flex-direction: column; gap: 8px; flex: 1; }
    .today-pages { display: flex; flex-direction: column; }
    .today-pages-label { font-size: .65rem; text-transform: uppercase; letter-spacing: .12em; color: var(--muted); }
    .today-pages-value { font-family: 'Cormorant Garamond', serif; font-size: 1.4rem; font-weight: 600; color: var(--primary-dark); }
    .today-surahs-label { font-size: .65rem; text-transform: uppercase; letter-spacing: .12em; color: var(--muted); margin-top: 2px; }
    .today-surahs-value { font-size: .82rem; color: var(--text); font-weight: 500; line-height: 1.5; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .today-hadith { display: flex; align-items: flex-start; gap: 6px; margin-top: 6px; font-size: .75rem; color: var(--muted); font-style: italic; line-height: 1.5; }
    .today-hadith .moon-small { display: inline-flex; align-items: center; justify-content: center; width: 18px; height: 18px; border-radius: 50%; background: #0f2d5e; flex-shrink: 0; margin-top: 1px; }
    .today-scroll-btn { display: inline-flex; align-items: center; gap: 6px; background: var(--primary); color: #fff; font-size: .75rem; font-weight: 500; letter-spacing: .08em; text-transform: uppercase; padding: 8px 16px; border-radius: 30px; border: none; cursor: pointer; font-family: inherit; white-space: nowrap; align-self: flex-start; margin-top: 4px; box-shadow: 0 4px 14px rgba(0,0,0,.18); transition: box-shadow 0.2s ease, transform 0.2s ease; }
    .today-scroll-btn:hover { box-shadow: 0 6px 20px rgba(0,0,0,.26); transform: translateY(-1px); }

    /* SECTION TITLE */
    .section-title { text-align: center; margin-bottom: 20px; }
    .section-title h2 { font-family: 'Cormorant Garamond', serif; font-size: clamp(1.3rem, 4vw, 1.9rem); font-weight: 600; color: var(--primary-dark); }
    .divider { display: flex; align-items: center; justify-content: center; gap: 10px; margin-top: 10px; }
    .divider span { height: 1px; width: 40px; background: var(--gold); display: block; }
    .divider i { width: 5px; height: 5px; background: var(--gold); transform: rotate(45deg); display: block; }

    /* LEGEND */
    .legend { display: flex; flex-wrap: wrap; gap: 8px; justify-content: center; margin-bottom: 20px; }
    .legend-item { display: flex; align-items: center; gap: 6px; background: var(--white); border-radius: 30px; padding: 5px 12px 5px 8px; box-shadow: 0 2px 8px rgba(0,0,0,.06); font-size: .78rem; font-weight: 500; }
    .legend-dot { width: 10px; height: 10px; border-radius: 50%; flex-shrink: 0; }

    /* TABLE */
    .table-wrap { overflow-x: auto; border-radius: 16px; box-shadow: 0 6px 32px rgba(36,100,93,.12); }
    table { width: 100%; border-collapse: collapse; background: var(--white); font-size: .875rem; }
    thead tr { background: var(--primary); }
    thead th { font-size: .7rem; font-weight: 500; text-transform: uppercase; letter-spacing: .1em; color: rgba(255,255,255,.7); padding: 14px 16px; text-align: left; white-space: nowrap; }
    tbody tr { border-bottom: 1px solid rgba(36,100,93,.07); transition: background .15s; border-left: 4px solid transparent; }
    tbody tr:last-child { border-bottom: none; }
    tbody tr:hover { background: rgba(36,100,93,.04); }
    tbody tr.today { background: var(--today-bg) !important; border-left-color: var(--today-green); }
    td { padding: 12px 16px; vertical-align: middle; }
    .td-dag { font-weight: 700; font-size: .95rem; color: var(--primary-dark); text-align: center; }
    .td-sidor { font-size: .8rem; color: var(--muted); white-space: nowrap; }
    .td-surah { font-size: .78rem; color: var(--primary-dark); max-width: 240px; line-height: 1.4; }
    .td-datum { font-size: .8rem; color: var(--muted); white-space: nowrap; }
    .td-datum.today-date { color: #1d7a4e; font-weight: 600; }
    .td-veckodag { font-size: .8rem; font-weight: 500; white-space: nowrap; }
    .fredag { color: #b45309; font-weight: 700; }
    .lordag { color: var(--primary-dark); }
    .sondag { color: #b45309; }
    .imam-chip { display: inline-flex; align-items: center; gap: 6px; padding: 4px 11px 4px 8px; border-radius: 30px; font-size: .78rem; font-weight: 500; color: #fff; white-space: nowrap; }
    .imam-chip .dot { width: 6px; height: 6px; border-radius: 50%; background: rgba(255,255,255,.35); flex-shrink: 0; }
    .imam-abdurrahman { background: var(--abdurrahman); }
    .imam-saed { background: var(--saed); color: #1a1a1a !important; }
    .imam-saed .dot { background: rgba(0,0,0,.15) !important; }
    .imam-noor { background: var(--noor); }
    .imam-abdul { background: var(--abdul); }
    .imam-mohammed { background: var(--mohammed); }
    .imam-yacquub { background: var(--yacquub); }
    .imam-abdelsalam { background: var(--abdelsalam); }
    .imam-hatem { background: var(--hatem); }
    .imam-ibrahim { background: var(--ibrahim); }
    .today-badge { display: inline-block; background: var(--today-green); color: #fff; font-size: .6rem; font-weight: 700; text-transform: uppercase; letter-spacing: .08em; padding: 2px 6px; border-radius: 8px; margin-left: 5px; vertical-align: middle; }

    /* TOOLTIP */
    .surah-cell { position: relative; cursor: pointer; }
    .surah-names { font-size: .78rem; color: var(--primary-dark); line-height: 1.5; }
    .surah-names span { display: inline; }

    .tooltip-box {
      display: none;
      position: absolute;
      left: 0; top: calc(100% + 6px);
      background: var(--primary-dark);
      color: #fff;
      font-size: .75rem;
      font-weight: 500;
      padding: 7px 12px;
      border-radius: 8px;
      white-space: nowrap;
      z-index: 100;
      box-shadow: 0 4px 16px rgba(0,0,0,.25);
      letter-spacing: .02em;
      pointer-events: none;
    }
    .tooltip-box::before {
      content: '';
      position: absolute;
      top: -5px; left: 12px;
      border-left: 5px solid transparent;
      border-right: 5px solid transparent;
      border-bottom: 5px solid var(--primary-dark);
    }
    /* Desktop: show on hover */
    @media (hover: hover) {
      .surah-cell:hover .tooltip-box { display: block; }
    }
    /* Mobile: show on click (toggled via JS) */
    .tooltip-box.visible { display: block; }

    /* MOBILE CARDS */
    .mobile-cards { display: none; }
    .day-card-mobile { background: var(--white); border-radius: 14px; padding: 14px 16px; margin-bottom: 10px; box-shadow: 0 2px 12px rgba(36,100,93,.08); border-left: 4px solid transparent; }
    .day-card-mobile.today { background: var(--today-bg); border-left-color: var(--today-green); }
    .dcm-top { display: flex; align-items: center; gap: 14px; margin-bottom: 8px; }
    .dcm-audio-right { display: flex; align-items: center; margin-left: auto; flex-shrink: 0; }
    .dcm-dag { font-weight: 700; font-size: 1.3rem; color: var(--primary-dark); min-width: 32px; text-align: center; flex-shrink: 0; }
    .dcm-dag.today-day { color: #1d7a4e; }
    .dcm-body { flex: 1; min-width: 0; }
    .dcm-imam { margin-bottom: 5px; }
    .dcm-meta { display: flex; align-items: center; gap: 8px; flex-wrap: wrap; }
    .dcm-date { font-size: .75rem; color: var(--muted); }
    .dcm-day-label { font-size: .75rem; font-weight: 500; }
    .dcm-pages { font-size: .75rem; color: var(--muted); background: rgba(36,100,93,.08); padding: 2px 8px; border-radius: 10px; }
    .dcm-surahs {
      margin-left: 46px; font-size: .78rem; color: var(--primary-dark);
      background: rgba(36,100,93,.06); border-radius: 8px; padding: 6px 10px; line-height: 1.5;
      position: relative; cursor: pointer;
    }
    .dcm-surahs-label { font-size: .65rem; text-transform: uppercase; letter-spacing: .1em; color: var(--muted); display: block; margin-bottom: 2px; }
    .dcm-tooltip {
      max-height: 0;
      overflow: hidden;
      opacity: 0;
      margin-top: 0;
      padding: 0 10px;
      background: var(--primary-dark);
      color: #fff;
      font-size: .75rem;
      font-weight: 500;
      border-radius: 7px;
      letter-spacing: .02em;
      transition:
        max-height 0.45s cubic-bezier(0.4, 0, 0.2, 1),
        opacity 0.35s ease,
        margin-top 0.35s ease,
        padding 0.35s ease;
    }
    .dcm-tooltip.visible {
      max-height: 80px;
      opacity: 1;
      margin-top: 6px;
      padding: 7px 10px;
    }

    footer { background: var(--primary-dark); text-align: center; padding: 24px 20px; color: rgba(255,255,255,.45); font-size: .8rem; letter-spacing: .05em; }
    footer strong { color: var(--gold); }

    /* LAST 10 NIGHTS */
    tbody tr.last-ten { background: var(--white); }
    tbody tr.last-ten.today { background: #0f2d5e !important; border-left-color: #3a7bd5; }
    tbody tr.last-ten.today td { color: #fff !important; }
    tbody tr.last-ten.today .td-sidor,
    tbody tr.last-ten.today .td-datum,
    tbody tr.last-ten.today .td-veckodag { color: rgba(255,255,255,0.75) !important; }
    tbody tr.last-ten.today .td-dag { color: #fff !important; }
    tbody tr.last-ten.today .today-date { color: #7eb8f7 !important; }
    tbody tr.last-ten.today .today-badge { background: #3a7bd5; }
    tbody tr.last-ten.today .td-surah .surah-names { color: rgba(255,255,255,0.9) !important; }
    tbody tr.last-ten.today .moon-icon {
      background: transparent !important;
      border: 2px solid rgba(255,255,255,0.8);
    }
    .day-card-mobile.last-ten.today .moon-icon {
      background: transparent !important;
      border: 2px solid rgba(255,255,255,0.8);
    }

    .moon-icon {
      display: inline-flex; align-items: center; justify-content: center;
      width: 20px; height: 20px; border-radius: 50%;
      background: #0f2d5e;
      vertical-align: middle;
      flex-shrink: 0;
    }
    /* AUDIO PLAY BUTTON */
    .play-btn {
      display: inline-flex; align-items: center; justify-content: center;
      width: 28px; height: 28px; border-radius: 50%;
      background: var(--primary); border: none; cursor: pointer;
      color: #fff; flex-shrink: 0;
      box-shadow: 0 2px 8px rgba(36,100,93,.3);
      transition: transform 0.15s ease, box-shadow 0.15s ease;
    }
    .play-btn:hover { transform: scale(1.1); box-shadow: 0 4px 12px rgba(36,100,93,.4); }
    .play-btn.playing { background: #c0392b; }
    .play-btn svg { display: block; }

    .td-audio { text-align: center; width: 36px; padding: 12px 4px 12px 8px; }
    .dcm-audio { display: inline-flex; align-items: center; margin-left: 5px; }

    /* Desktop: moon gets its own cell, right-aligned */
    .td-moon {
      text-align: center;
      width: 32px;
      padding: 12px 8px 12px 0;
    }
    .moon-icon svg { display: block; }

    /* Moon tooltip */
    .moon-wrap {
      position: relative;
      display: inline-flex;
      align-items: center;
    }
    .moon-tooltip {
      position: absolute;
      bottom: calc(100% + 8px);
      right: 0;
      width: 240px;
      background: #0f2d5e;
      color: #fff;
      font-size: .72rem;
      line-height: 1.55;
      padding: 10px 12px;
      border-radius: 10px;
      box-shadow: 0 6px 20px rgba(0,0,0,.3);
      z-index: 200;
      pointer-events: none;
      font-style: italic;
      opacity: 0;
      visibility: hidden;
      transform: translateY(4px);
      transition: opacity 0.35s ease, visibility 0.35s ease, transform 0.35s ease;
    }
    .moon-tooltip::after {
      content: '';
      position: absolute;
      top: 100%; right: 6px;
      border-left: 6px solid transparent;
      border-right: 6px solid transparent;
      border-top: 6px solid #0f2d5e;
    }
    .moon-wrap:hover .moon-tooltip,
    .moon-wrap.active .moon-tooltip {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }

    /* Today card moon */
    .today-moon-wrap {
      position: relative;
      display: inline-flex;
      align-items: center;
      margin-left: 8px;
      vertical-align: middle;
    }
    .today-moon-icon {
      display: inline-flex; align-items: center; justify-content: center;
      width: 22px; height: 22px; border-radius: 50%;
      background: #0f2d5e;
      border: 2px solid rgba(255,255,255,0.3);
      cursor: default;
      animation: moonPulse 2s ease-in-out infinite;
    }
    @keyframes moonPulse {
      0%, 100% { box-shadow: 0 0 0 0 rgba(58,123,213,0.5); }
      50% { box-shadow: 0 0 0 6px rgba(58,123,213,0); }
    }
    .today-moon-tooltip {
      position: absolute;
      bottom: calc(100% + 8px);
      left: 50%;
      transform: translateX(-50%) translateY(4px);
      width: 240px;
      background: #0f2d5e;
      color: #fff;
      font-size: .72rem;
      line-height: 1.55;
      padding: 10px 12px;
      border-radius: 10px;
      box-shadow: 0 6px 20px rgba(0,0,0,.3);
      z-index: 200;
      pointer-events: none;
      font-style: italic;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.35s ease, visibility 0.35s ease, transform 0.35s ease;
    }
    .today-moon-tooltip::after {
      content: '';
      position: absolute;
      top: 100%; left: 50%;
      transform: translateX(-50%);
      border-left: 6px solid transparent;
      border-right: 6px solid transparent;
      border-top: 6px solid #0f2d5e;
    }
    .today-moon-wrap:hover .today-moon-tooltip,
    .today-moon-wrap.active .today-moon-tooltip {
      opacity: 1;
      visibility: visible;
      transform: translateX(-50%) translateY(0);
    }

    /* mobile last-ten */
    .day-card-mobile.last-ten { background: var(--white); }
    .day-card-mobile.last-ten.today { background: #0f2d5e !important; border-left-color: #3a7bd5; }
    .day-card-mobile.last-ten.today .dcm-dag,
    .day-card-mobile.last-ten.today .dcm-date,
    .day-card-mobile.last-ten.today .dcm-day-label { color: rgba(255,255,255,0.85) !important; }
    .day-card-mobile.last-ten.today .imam-chip { opacity: 0.95; }
    .day-card-mobile.last-ten.today .dcm-surahs { background: rgba(255,255,255,0.08); color: rgba(255,255,255,0.9); }
    .day-card-mobile.last-ten.today .dcm-surahs-label { color: rgba(255,255,255,0.5); }
    .day-card-mobile.last-ten.today .dcm-pages { background: rgba(255,255,255,0.12); color: rgba(255,255,255,0.7); }
    .day-card-mobile.last-ten.today .today-badge { background: #3a7bd5; }
    .day-card-mobile.last-ten.today .dcm-dag.today-day { color: #7eb8f7 !important; }

    @keyframes fadeUp { from { opacity: 0; transform: translateY(18px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes cardPulse {
      0%   { box-shadow: 0 8px 32px rgba(36,100,93,.14), 0 0 0 0 var(--card-pulse, rgba(255,255,255,0.3)); }
      40%  { box-shadow: 0 8px 32px rgba(36,100,93,.14), 0 0 0 14px rgba(0,0,0,0); }
      66%  { box-shadow: 0 8px 32px rgba(36,100,93,.14), 0 0 0 0 rgba(0,0,0,0); }
      100% { box-shadow: 0 8px 32px rgba(36,100,93,.14), 0 0 0 0 rgba(0,0,0,0); }
    }
    .today-card.pulsing {
      animation: cardPulse 3s ease-out infinite;
      animation-delay: 0.5s;
    }

    @keyframes chipPulse {
      0%   { box-shadow: 0 0 0 0 var(--pulse-color, rgba(0,0,0,0.4)); }
      50%  { box-shadow: 0 0 0 10px rgba(0,0,0,0); }
      100% { box-shadow: 0 0 0 0 rgba(0,0,0,0); }
    }
    .filter-chip.active {
      animation: chipPulse 2s ease-out infinite;
    }

    /* FILTER */
    .filter-wrap { margin-bottom: 20px; display: flex; flex-direction: column; align-items: center; gap: 10px; }
    .filter-chips { display: flex; flex-wrap: wrap; gap: 8px; justify-content: center; }
    .filter-chip {
      display: inline-flex; align-items: center; gap: 6px;
      background: var(--white); border: 1.5px solid transparent;
      border-radius: 30px; padding: 5px 12px 5px 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,.06);
      font-size: .78rem; font-weight: 500; font-family: inherit;
      cursor: pointer; color: var(--text);
      transition: all 0.2s ease;
    }
    .filter-chip:hover { box-shadow: 0 3px 12px rgba(0,0,0,.12); transform: translateY(-1px); }
    .filter-chip.active {
      background: var(--primary-dark); color: #fff;
      border-color: var(--primary-dark);
      box-shadow: 0 4px 14px rgba(26,74,68,.3);
    }
    .filter-chip.active .filter-dot { border-color: rgba(255,255,255,.4) !important; }
    .filter-dot { width: 10px; height: 10px; border-radius: 50%; flex-shrink: 0; }


    /* hidden rows */
    tbody tr.filtered-out { display: none; }
    .day-card-mobile.filtered-out { display: none; }

    @media (max-width: 640px) {
      header { padding: 20px 16px 18px; }
      main { padding: 24px 12px 60px; }
      .table-wrap { display: none; }
      .mobile-cards { display: block; }
      .filter-chips { flex-direction: row; flex-wrap: wrap; justify-content: flex-start; width: 100%; gap: 8px; }
      .filter-chip { justify-content: flex-start; border-radius: 30px; padding: 6px 12px 6px 8px; font-size: .8rem; flex: 0 1 auto; }
      .filter-wrap { align-items: flex-start; }
      .filter-clear { align-self: flex-start; }
    }
  </style>
</head>
<body>

<header>
  <div class="ornament">
    <div class="orn-line l"></div><div class="orn-dot"></div>
    <div class="orn-diamond"></div><div class="orn-dot"></div>
    <div class="orn-line r"></div>
  </div>
  <h1>Tarawih Schema<br>Ramadan 2026</h1>
  <div class="header-address">
    <div class="addr-text">
      <svg xmlns="http://www.w3.org/2000/svg" width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg>
      TenstastrÃ¥ket 16, 163 61 SpÃ¥nga
    </div>
    <a href="https://www.google.com/maps/search/?api=1&query=TenstastrÃ¥ket+16,+163+61+SpÃ¥nga" target="_blank">
      <svg xmlns="http://www.w3.org/2000/svg" width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg>
      Hitta hit
    </a>
  </div>
</header>

<div class="wave">
  <svg viewBox="0 0 1440 56" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none">
    <path d="M0,28 C400,65 1040,-9 1440,28 L1440,0 L0,0 Z" fill="#24645d"/>
  </svg>
</div>

<main>

  <!-- TODAY CARD -->
  <div class="today-card" id="today-card">
    <div class="today-card-top">
      <div class="today-avatar" id="today-avatar">?</div>
      <div class="today-card-info">
        <span class="today-card-label">Dagens Imam</span>
        <span class="today-card-name" id="today-imam-name">â€”</span>
        <span class="today-card-date" id="today-date-label">â€”</span>
      </div>
    </div>
    <div class="today-card-bottom">
      <div class="today-bottom-left">
        <div class="today-pages">
          <span class="today-pages-label">Sidor idag</span>
          <span class="today-pages-value" id="today-pages">â€”</span>
        </div>
        <div>
          <span class="today-surahs-label">Suror</span>
          <span class="today-surahs-value" id="today-surahs">â€”</span>
        </div>
      </div>
      <button class="today-scroll-btn" onclick="scrollToToday()">â†“ Se i schemat</button>
    </div>
  </div>

  <!-- SECTION TITLE -->
  <div class="section-title">
    <h2>Imamernas BÃ¶neledning</h2>
    <div class="divider"><span></span><i></i><span></span></div>
  </div>

  <!-- FILTER -->
  <div class="filter-wrap" id="filter-wrap">
    <div class="filter-chips" id="filter-chips">
      <button class="filter-chip" data-imam="abdurrahman" onclick="toggleFilter('abdurrahman')"><span class="filter-dot" style="background:var(--abdurrahman)"></span>Abdurrahman Sudani</button>
      <button class="filter-chip" data-imam="saed" onclick="toggleFilter('saed')"><span class="filter-dot" style="background:var(--saed);border:1px solid #bbb"></span>Saed Magan</button>
      <button class="filter-chip" data-imam="noor" onclick="toggleFilter('noor')"><span class="filter-dot" style="background:var(--noor)"></span>Noor</button>
      <button class="filter-chip" data-imam="abdul" onclick="toggleFilter('abdul')"><span class="filter-dot" style="background:var(--abdul)"></span>Abdul Qadir</button>
      <button class="filter-chip" data-imam="mohammed" onclick="toggleFilter('mohammed')"><span class="filter-dot" style="background:var(--mohammed)"></span>Mohammed Haji</button>
      <button class="filter-chip" data-imam="yacquub" onclick="toggleFilter('yacquub')"><span class="filter-dot" style="background:var(--yacquub)"></span>Yacquub</button>
      <button class="filter-chip" data-imam="ibrahim" onclick="toggleFilter('ibrahim')"><span class="filter-dot" style="background:var(--ibrahim)"></span>Ibrahim Noor</button>
      <button class="filter-chip" data-imam="abdelsalam" onclick="toggleFilter('abdelsalam')"><span class="filter-dot" style="background:var(--abdelsalam)"></span>Abdelsalam Nour</button>
      <button class="filter-chip" data-imam="hatem" onclick="toggleFilter('hatem')"><span class="filter-dot" style="background:var(--hatem)"></span>Hatem</button>
    </div>
  </div>

  <!-- DESKTOP TABLE -->
  <div class="table-wrap">
    <table>
      <thead>
        <tr>
          <th>#</th>
          <th>Sidor</th>
          <th>Suror</th>
          <th>Imam</th>
          <th>Datum</th>
          <th></th>
          <th></th>
          <th>Dag</th>
        </tr>
      </thead>
      <tbody id="table-body"></tbody>
    </table>
  </div>

  <!-- MOBILE CARDS -->
  <div class="mobile-cards" id="mobile-cards"></div>

</main>

<footer>
  <a href="https://www.instagram.com/sverigesimamer/" target="_blank" rel="noopener" style="display:inline-flex;align-items:center;gap:7px;color:rgba(255,255,255,.65);text-decoration:none;margin-bottom:12px;font-size:.82rem;transition:color 0.2s;" onmouseover="this.style.color='#fff'" onmouseout="this.style.color='rgba(255,255,255,.65)'">
    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"/><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"/><line x1="17.5" y1="6.5" x2="17.51" y2="6.5"/></svg>
    @sverigesimamer
  </a>
  <br>
  &copy; 2026 &nbsp;<strong>Sveriges Imamer</strong>&nbsp; â€” Tarawih Schema Ramadan 1447
</footer>

<script>
  // tooltip = "Surah:Aya â€“ Surah:Aya" format
  // surahs = display names without numbers
  const SCHEDULE = [
    {day:1,  sidor:'2â€“11',    imam:'abdurrahman', imamLabel:'Abdurrahman Sudani', datum:'2026-02-17', vecka:'Tisdag',   surahs:'Al-Baqarah',                                                                                                        tooltip:'2:1 â€“ 2:74'},
    {day:2,  sidor:'11â€“21',  imam:'saed',        imamLabel:'Saed Magan',         datum:'2026-02-18', vecka:'Onsdag',   surahs:'Al-Baqarah',                                                                                                        tooltip:'2:75 â€“ 2:141'},
    {day:3,  sidor:'22â€“31',  imam:'noor',        imamLabel:'Noor',               datum:'2026-02-19', vecka:'Torsdag',  surahs:'Al-Baqarah',                                                                                                        tooltip:'2:142 â€“ 2:202'},
    {day:4,  sidor:'32â€“41',  imam:'abdul',       imamLabel:'Abdul Qadir',        datum:'2026-02-20', vecka:'Fredag',   surahs:'Al-Baqarah',                                                                                                        tooltip:'2:203 â€“ 2:265'},
    {day:5,  sidor:'42â€“51',  imam:'mohammed',    imamLabel:'Mohammed Haji',      datum:'2026-02-21', vecka:'LÃ¶rdag',   surahs:'Al-Baqarah, Ali Imran',                                                                                             tooltip:'2:266 â€“ 3:14'},
    {day:6,  sidor:'51â€“62',  imam:'abdurrahman', imamLabel:'Abdurrahman Sudani', datum:'2026-02-22', vecka:'SÃ¶ndag',   surahs:'Ali Imran',                                                                                                         tooltip:'3:15 â€“ 3:92'},
    {day:7,  sidor:'62â€“72',  imam:'abdurrahman', imamLabel:'Abdurrahman Sudani', datum:'2026-02-23', vecka:'MÃ¥ndag',   surahs:'Ali Imran',                                                                                                         tooltip:'3:93 â€“ 3:170'},
    {day:8,  sidor:'72â€“81',  imam:'saed',        imamLabel:'Saed Magan',         datum:'2026-02-24', vecka:'Tisdag',   surahs:'Ali Imran, An-Nisa',                                                                                                tooltip:'3:171 â€“ 4:23'},
    {day:9,  sidor:'82â€“92',  imam:'ibrahim',     imamLabel:'Ibrahim Noor',        datum:'2026-02-25', vecka:'Onsdag',   surahs:'An-Nisa',                                                                                                           tooltip:'4:24 â€“ 4:87'},
    {day:10, sidor:'92â€“101', imam:'saed',        imamLabel:'Saed Magan',         datum:'2026-02-26', vecka:'Torsdag',  surahs:'An-Nisa',                                                                                                           tooltip:'4:88 â€“ 4:147'},
    {day:11, sidor:'102â€“106',imam:'mohammed',    imamLabel:'Mohammed Haji',      datum:'2026-02-27', vecka:'Fredag',   surahs:'An-Nisa, Fatir',                                                                                                    tooltip:'4:148 â€“ 35:30'},
    {day:12, sidor:'438â€“449',imam:'saed',        imamLabel:'Saed Magan',         datum:'2026-02-28', vecka:'LÃ¶rdag',   surahs:'Fatir, Ya-Sin',                                                                                                     tooltip:'35:31 â€“ 36:82'},
    {day:13, sidor:'449â€“458',imam:'abdelsalam',  imamLabel:'Abdelsalam Nour',    datum:'2026-03-01', vecka:'SÃ¶ndag',   surahs:'Ya-Sin, As-Saffat, Sad',                                                                                            tooltip:'36:83 â€“ 38:88'},
    {day:14, sidor:'458â€“467',imam:'saed',        imamLabel:'Saed Magan',         datum:'2026-03-02', vecka:'MÃ¥ndag',   surahs:'Az-Zumar',                                                                                                          tooltip:'39:1 â€“ 39:75'},
    {day:15, sidor:'467â€“476',imam:'noor',        imamLabel:'Noor',               datum:'2026-03-03', vecka:'Tisdag',   surahs:'Ghafir',                                                                                                            tooltip:'40:1 â€“ 40:85'},
    {day:16, sidor:'476â€“486',imam:'mohammed',    imamLabel:'Mohammed Haji',      datum:'2026-03-04', vecka:'Onsdag',   surahs:'Fussilat, Ash-Shura',                                                                                               tooltip:'41:1 â€“ 42:26'},
    {day:17, sidor:'486â€“495',imam:'saed',        imamLabel:'Saed Magan',         datum:'2026-03-05', vecka:'Torsdag',  surahs:'Ash-Shura, Az-Zukhruf',                                                                                             tooltip:'42:27 â€“ 43:89'},
    {day:18, sidor:'496â€“506',imam:'saed',        imamLabel:'Saed Magan',         datum:'2026-03-06', vecka:'Fredag',   surahs:'Ad-Dukhan, Al-Jathiyah, Al-Ahqaf',                                                                                  tooltip:'44:1 â€“ 46:35'},
    {day:19, sidor:'507â€“515',imam:'yacquub',     imamLabel:'Yacquub',            datum:'2026-03-07', vecka:'LÃ¶rdag',   surahs:'Muhammad, Al-Fath',                                                                                                 tooltip:'47:1 â€“ 48:29'},
    {day:20, sidor:'515â€“523',imam:'yacquub',     imamLabel:'Yacquub',            datum:'2026-03-08', vecka:'SÃ¶ndag',   surahs:'Al-Hujurat, Qaf, Adh-Dhariyat',                                                                                     tooltip:'49:1 â€“ 51:60'},
    {day:21, sidor:'523â€“531',imam:'noor',        imamLabel:'Noor',               datum:'2026-03-09', vecka:'MÃ¥ndag',   surahs:'At-Tur, An-Najm, Al-Qamar',                                                                                         tooltip:'52:1 â€“ 54:55'},
    {day:22, sidor:'531â€“539',imam:'mohammed',    imamLabel:'Mohammed Haji',      datum:'2026-03-10', vecka:'Tisdag',   surahs:'Ar-Rahman, Al-Waqiah, Al-Hadid',                                                                                    tooltip:'55:1 â€“ 57:15'},
    {day:23, sidor:'539â€“548',imam:'abdurrahman', imamLabel:'Abdurrahman Sudani', datum:'2026-03-11', vecka:'Onsdag',   surahs:'Al-Hadid, Al-Mujadilah, Al-Hashr',                                                                                  tooltip:'57:16 â€“ 59:24'},
    {day:24, sidor:'549â€“557',imam:'abdul',       imamLabel:'Abdul Qadir',        datum:'2026-03-12', vecka:'Torsdag',  surahs:'Al-Mumtahanah, As-Saf, Al-Jumuah, Al-Munafiqun, At-Taghabun',                                                       tooltip:'60:1 â€“ 64:18'},
    {day:25, sidor:'558â€“566',imam:'hatem',       imamLabel:'Hatem',              datum:'2026-03-13', vecka:'Fredag',   surahs:'At-Talaq, At-Tahrim, Al-Mulk, Al-Qalam',                                                                            tooltip:'65:1 â€“ 68:52'},
    {day:26, sidor:'566â€“574',imam:'abdurrahman', imamLabel:'Abdurrahman Sudani', datum:'2026-03-14', vecka:'LÃ¶rdag',   surahs:'Al-Haqqah, Al-Maarij, Nuh, Al-Jinn, Al-Muzzammil',                                                                  tooltip:'69:1 â€“ 73:20'},
    {day:27, sidor:'575â€“583',imam:'noor',        imamLabel:'Noor',               datum:'2026-03-15', vecka:'SÃ¶ndag',   surahs:'Al-Muddaththir, Al-Qiyamah, Al-Insan, Al-Mursalat, An-Naba',                                                         tooltip:'74:1 â€“ 78:40'},
    {day:28, sidor:'583â€“591',imam:'mohammed',    imamLabel:'Mohammed Haji',      datum:'2026-03-16', vecka:'MÃ¥ndag',   surahs:'An-Naziat, Abasa, At-Takwir, Al-Infitar, Al-Mutaffifin, Al-Inshiqaq, Al-Buruj, At-Tariq, Al-Ala',                    tooltip:'79:1 â€“ 87:19'},
    {day:29, sidor:'592â€“604',imam:'yacquub',     imamLabel:'Yacquub',            datum:'2026-03-17', vecka:'Tisdag',   surahs:'Al-Ghashiyah, Al-Fajr, Al-Balad, Ash-Shams, Al-Layl, Ad-Duha, Ash-Sharh, At-Tin, Al-Alaq, Al-Qadr, Al-Bayyinah, Az-Zalzalah, Al-Adiyat, Al-Qariah, At-Takathur, Al-Asr, Al-Humazah, Al-Fil, Quraysh, Al-Maun, Al-Kawthar, Al-Kafirun, An-Nasr, Al-Masad, Al-Ikhlas, Al-Falaq, An-Nas', tooltip:'88:1 â€“ 114:6'},
    {day:30, sidor:'2â€“11',   imam:'noor',        imamLabel:'Noor',               datum:'2026-03-18', vecka:'Onsdag',   surahs:'Al-Baqarah',                                                                                                        tooltip:'2:1 â€“ 2:74'},
  ];

  const DAYS   = ['SÃ¶ndag','MÃ¥ndag','Tisdag','Onsdag','Torsdag','Fredag','LÃ¶rdag'];
  const MONTHS = ['januari','februari','mars','april','maj','juni','juli','augusti','september','oktober','november','december'];
  const today  = new Date().toISOString().slice(0, 10);

  function scrollToToday() {
    // On mobile the table is hidden, so use the mobile card; otherwise use the desktop row
    const isMobile = window.innerWidth <= 640;
    const el = document.getElementById(isMobile ? 'today-row-mobile' : 'today-row-desktop');
    if (!el) return;
    const y = el.getBoundingClientRect().top + window.scrollY - 80;
    window.scrollTo({ top: y, behavior: 'smooth' });
  }

  // Close all tooltips on outside click (mobile)
  document.addEventListener('click', (e) => {
    if (!e.target.closest('.surah-cell') && !e.target.closest('.dcm-surahs')) {
      document.querySelectorAll('.tooltip-box.visible, .dcm-tooltip.visible').forEach(el => el.classList.remove('visible'));
    }
    if (!e.target.closest('.moon-wrap') && !e.target.closest('.today-moon-wrap')) {
      document.querySelectorAll('.moon-wrap.active, .today-moon-wrap.active').forEach(el => el.classList.remove('active'));
    }
  });

  // Moon tap toggle for mobile
  document.addEventListener('click', (e) => {
    const moonWrap = e.target.closest('.moon-wrap, .today-moon-wrap');
    if (moonWrap) {
      const isActive = moonWrap.classList.contains('active');
      document.querySelectorAll('.moon-wrap.active, .today-moon-wrap.active').forEach(el => el.classList.remove('active'));
      if (!isActive) moonWrap.classList.add('active');
      e.stopPropagation();
    }
  });

  // Build desktop table rows
  const tbody = document.getElementById('table-body');
  SCHEDULE.forEach(row => {
    const isToday = row.datum === today;
    const tr = document.createElement('tr');
    if (isToday) { tr.classList.add('today'); tr.id = 'today-row-desktop'; }
    const veckaClass = row.vecka === 'Fredag' ? 'fredag' : row.vecka === 'LÃ¶rdag' ? 'lordag' : row.vecka === 'SÃ¶ndag' ? 'sondag' : '';
    const badge = isToday ? '<span class="today-badge">Idag</span>' : '';

    const isLastTen = row.day >= 21;
    if (isLastTen) tr.classList.add('last-ten');
    const moonIcon = isLastTen ? `<span class="moon-wrap"><span class="moon-icon"><svg width="12" height="12" viewBox="0 0 24 24" fill="white" xmlns="http://www.w3.org/2000/svg"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg></span><span class="moon-tooltip">Profeten ï·º sade: "Den som stÃ¥r upp i nattbÃ¶n under Laylatul-Qadr med tro och i hopp om belÃ¶ning fÃ¥r sina tidigare synder fÃ¶rlÃ¥tna." [al-Bukhari och Muslim]</span></span>` : '';
    tr.innerHTML = `
      <td class="td-dag">${row.day}</td>
      <td class="td-sidor">${row.sidor}</td>
      <td class="td-surah surah-cell" tabindex="0">
        <div class="surah-names">${row.surahs}</div>
        <div class="tooltip-box">ðŸ“– ${row.tooltip}</div>
      </td>
      <td><span class="imam-chip imam-${row.imam}"><span class="dot"></span>${row.imamLabel}</span></td>
      <td class="td-datum ${isToday ? 'today-date' : ''}">${row.datum}${badge}</td>
      <td class="td-audio" id="audio-desktop-${row.datum}"></td>
      <td class="td-moon">${moonIcon}</td>
      <td class="td-veckodag ${veckaClass}">${row.vecka}</td>
    `;

    // Mobile click toggle for tooltip
    const cell = tr.querySelector('.surah-cell');
    cell.addEventListener('click', (e) => {
      const tip = cell.querySelector('.tooltip-box');
      const isVisible = tip.classList.contains('visible');
      document.querySelectorAll('.tooltip-box.visible').forEach(el => el.classList.remove('visible'));
      if (!isVisible) tip.classList.add('visible');
      e.stopPropagation();
    });

    tbody.appendChild(tr);
  });

  // Build mobile cards
  const container = document.getElementById('mobile-cards');
  SCHEDULE.forEach(row => {
    const isToday = row.datum === today;
    const card = document.createElement('div');
    const isLastTenM = row.day >= 21;
    card.className = 'day-card-mobile' + (isToday ? ' today' : '') + (isLastTenM ? ' last-ten' : '');
    if (isToday) card.id = 'today-row-mobile';
    const veckaClass = row.vecka === 'Fredag' ? 'fredag' : row.vecka === 'LÃ¶rdag' ? 'lordag' : row.vecka === 'SÃ¶ndag' ? 'sondag' : '';
    const badge = isToday ? '<span class="today-badge">Idag</span>' : '';
    const moonSpan = isLastTenM ? `<span class='moon-wrap' style='margin-left:5px;'><span class='moon-icon'><svg width='11' height='11' viewBox='0 0 24 24' fill='white'><path d='M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z'/></svg></span><span class='moon-tooltip' style='right:auto;left:0;'>Profeten ï·º sade: "Den som stÃ¥r upp i nattbÃ¶n under Laylatul-Qadr med tro och i hopp om belÃ¶ning fÃ¥r sina tidigare synder fÃ¶rlÃ¥tna." [al-Bukhari och Muslim]</span></span>` : '';
    card.innerHTML = `
      <div class="dcm-top">
        <div class="dcm-dag ${isToday ? 'today-day' : ''}">${row.day}</div>
        <div class="dcm-body">
          <div class="dcm-imam"><span class="imam-chip imam-${row.imam}"><span class="dot"></span>${row.imamLabel}</span></div>
          <div class="dcm-meta">
            <span class="dcm-date">${row.datum}${badge}</span>
            ${moonSpan}
            <span class="dcm-day-label ${veckaClass}">${row.vecka}</span>
            <span class="dcm-pages">s. ${row.sidor}</span>
          </div>
        </div>
        <div class="dcm-audio-right" id="audio-mobile-${row.datum}"></div>
      </div>
      <div class="dcm-surahs">
        <span class="dcm-surahs-label">Suror â€” tryck fÃ¶r detaljer</span>
        ${row.surahs}
        <div class="dcm-tooltip">ðŸ“– ${row.tooltip}</div>
      </div>
    `;

    // Toggle tooltip on tap with smooth scroll after expand
    const surahBox = card.querySelector('.dcm-surahs');
    surahBox.addEventListener('click', (e) => {
      const tip = surahBox.querySelector('.dcm-tooltip');
      const isVisible = tip.classList.contains('visible');
      document.querySelectorAll('.dcm-tooltip.visible').forEach(el => el.classList.remove('visible'));
      if (!isVisible) {
        tip.classList.add('visible');
        setTimeout(() => {
          surahBox.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }, 220);
      }
      e.stopPropagation();
    });

    container.appendChild(card);
  });

  // Populate today card
  const todayData = SCHEDULE.find(r => r.datum === today);
  if (todayData) {
    const d = new Date(today);
    document.getElementById('today-imam-name').textContent = todayData.imamLabel;
    const dateLabel = DAYS[d.getDay()] + ' ' + d.getDate() + ' ' + MONTHS[d.getMonth()];
    if (todayData.day >= 21) {
      const dateEl = document.getElementById('today-date-label');
      dateEl.textContent = dateLabel;
      const moonWrap = document.createElement('span');
      moonWrap.className = 'today-moon-wrap';
      moonWrap.innerHTML = `<span class="today-moon-icon"><svg width="12" height="12" viewBox="0 0 24 24" fill="white"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg></span><span class="today-moon-tooltip">Profeten ï·º sade: "Den som stÃ¥r upp i nattbÃ¶n under Laylatul-Qadr med tro och i hopp om belÃ¶ning fÃ¥r sina tidigare synder fÃ¶rlÃ¥tna." [al-Bukhari och Muslim]</span>`;
      dateEl.parentNode.insertBefore(moonWrap, dateEl.nextSibling);
    } else {
      document.getElementById('today-date-label').textContent = dateLabel;
    }
    document.getElementById('today-pages').textContent = 'Sidor ' + todayData.sidor;
    document.getElementById('today-surahs').textContent = todayData.surahs + '  (' + todayData.tooltip + ')';

    // Add hadith row below suror for last-ten nights
    if (todayData.day >= 21) {
      const hadithEl = document.createElement('div');
      hadithEl.className = 'today-hadith';
      hadithEl.innerHTML = `
        <span class="moon-small"><svg width="10" height="10" viewBox="0 0 24 24" fill="white"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg></span>
        <span>Profeten ï·º sade: "Den som stÃ¥r upp i nattbÃ¶n under Laylatul-Qadr med tro och i hopp om belÃ¶ning fÃ¥r sina tidigare synder fÃ¶rlÃ¥tna." [al-Bukhari och Muslim]</span>
      `;
      document.getElementById('today-surahs').parentNode.appendChild(hadithEl);
    }
    const avatarEl = document.getElementById('today-avatar');
    avatarEl.textContent = todayData.imamLabel.charAt(0);
    const avatarPulseColors = {
      abdurrahman: 'rgba(232,99,10,0.55)',
      saed:        'rgba(212,168,0,0.55)',
      noor:        'rgba(41,128,185,0.55)',
      abdul:       'rgba(100,100,100,0.55)',
      mohammed:    'rgba(33,145,80,0.55)',
      yacquub:     'rgba(125,58,172,0.55)',
      ibrahim:     'rgba(26,107,138,0.55)',
      abdelsalam:  'rgba(123,63,0,0.55)',
      hatem:       'rgba(45,106,79,0.55)',
    };

    const todayCard = document.getElementById('today-card');
    todayCard.style.display = 'block';
    todayCard.style.setProperty('--card-pulse', avatarPulseColors[todayData.imam] || 'rgba(255,255,255,0.3)');
    todayCard.classList.add('pulsing');
    setTimeout(() => {
      const card = document.getElementById('today-card');
      const targetY = card.getBoundingClientRect().top + window.scrollY - 20;
      const startY = window.scrollY;
      const dist = targetY - startY;
      const duration = 1100;
      let start = null;
      function easeInOutCubic(t) {
        return t < 0.5 ? 4 * t * t * t : 1 - Math.pow(-2 * t + 2, 3) / 2;
      }
      function step(ts) {
        if (!start) start = ts;
        const elapsed = ts - start;
        const progress = Math.min(elapsed / duration, 1);
        window.scrollTo(0, startY + dist * easeInOutCubic(progress));
        if (progress < 1) requestAnimationFrame(step);
      }
      requestAnimationFrame(step);
    }, 3000);
  }

  // â”€â”€ AUDIO â”€â”€
  const audioState = {}; // datum -> Audio object

  const PLAY_ICON = `<svg width="10" height="10" viewBox="0 0 24 24" fill="currentColor"><polygon points="5,3 19,12 5,21"/></svg>`;
  const PAUSE_ICON = `<svg width="10" height="10" viewBox="0 0 24 24" fill="currentColor"><rect x="6" y="3" width="4" height="18"/><rect x="14" y="3" width="4" height="18"/></svg>`;

  function createPlayBtn(datum) {
    const btn = document.createElement('button');
    btn.className = 'play-btn';
    btn.title = 'Spela upp recitation';
    btn.innerHTML = PLAY_ICON;
    btn.addEventListener('click', (e) => {
      e.stopPropagation();
      toggleAudio(datum, btn);
    });
    return btn;
  }

  function toggleAudio(datum, btn) {
    // Pause all others
    Object.keys(audioState).forEach(d => {
      if (d !== datum && audioState[d]) {
        audioState[d].pause();
        // Reset all buttons for this datum
        document.querySelectorAll(`.play-btn[data-datum="${d}"]`).forEach(b => {
          b.innerHTML = PLAY_ICON;
          b.classList.remove('playing');
        });
      }
    });

    if (!audioState[datum]) {
      audioState[datum] = new Audio(`/${datum}.mp3`);
      audioState[datum].addEventListener('ended', () => {
        document.querySelectorAll(`.play-btn[data-datum="${datum}"]`).forEach(b => {
          b.innerHTML = PLAY_ICON;
          b.classList.remove('playing');
        });
      });
    }

    const audio = audioState[datum];
    if (audio.paused) {
      audio.play();
      document.querySelectorAll(`.play-btn[data-datum="${datum}"]`).forEach(b => {
        b.innerHTML = PAUSE_ICON;
        b.classList.add('playing');
      });
    } else {
      audio.pause();
      document.querySelectorAll(`.play-btn[data-datum="${datum}"]`).forEach(b => {
        b.innerHTML = PLAY_ICON;
        b.classList.remove('playing');
      });
    }
  }

  // Check which audio files exist using Audio element (avoids CORS issues on GitHub Pages)
  function injectPlayButtons(datum) {
    const desktopCell = document.getElementById(`audio-desktop-${datum}`);
    if (desktopCell) {
      const btn = createPlayBtn(datum);
      btn.setAttribute('data-datum', datum);
      desktopCell.appendChild(btn);
    }
    const mobileCell = document.getElementById(`audio-mobile-${datum}`);
    if (mobileCell) {
      const btn = createPlayBtn(datum);
      btn.setAttribute('data-datum', datum);
      mobileCell.appendChild(btn);
    }
  }

  SCHEDULE.forEach(row => {
    const audio = new Audio();
    audio.addEventListener('canplaythrough', () => injectPlayButtons(row.datum), { once: true });
    audio.addEventListener('loadedmetadata', () => injectPlayButtons(row.datum), { once: true });
    audio.preload = 'metadata';
    audio.src = `/${row.datum}.mp3`;
  });

  // â”€â”€ FILTER â”€â”€
  let activeFilter = null;

  function toggleFilter(imam) {
    activeFilter = (activeFilter === imam) ? null : imam;
    applyFilter();
    // Scroll to top of schedule after filter applied
    if (activeFilter) {
      setTimeout(() => {
        const target = window.innerWidth <= 640
          ? document.getElementById('mobile-cards')
          : document.querySelector('.table-wrap');
        if (target) {
          const y = target.getBoundingClientRect().top + window.scrollY - 90;
          window.scrollTo({ top: y, behavior: 'smooth' });
        }
      }, 80);
    }
  }

  function applyFilter() {
    // Lock body width before any DOM changes to prevent scrollbar-caused layout shift
    document.body.style.width = document.body.offsetWidth + 'px';
    document.body.style.overflowY = 'hidden';

    // Update chip states
    const imamColors = {
      abdurrahman: 'rgba(232,99,10,0.5)',
      saed:        'rgba(212,168,0,0.5)',
      noor:        'rgba(41,128,185,0.5)',
      abdul:       'rgba(44,44,44,0.5)',
      mohammed:    'rgba(33,145,80,0.5)',
      yacquub:     'rgba(125,58,172,0.5)',
      ibrahim:     'rgba(26,107,138,0.5)',
      abdelsalam:  'rgba(123,63,0,0.5)',
      hatem:       'rgba(45,106,79,0.5)',
    };
    document.querySelectorAll('.filter-chip').forEach(btn => {
      const isActive = btn.dataset.imam === activeFilter;
      btn.classList.toggle('active', isActive);
      if (isActive) {
        btn.style.setProperty('--pulse-color', imamColors[btn.dataset.imam] || 'rgba(0,0,0,0.3)');
      } else {
        btn.style.removeProperty('--pulse-color');
      }
    });

    // Hide non-matching instantly
    document.querySelectorAll('#table-body tr').forEach(tr => {
      const chip = tr.querySelector('.imam-chip');
      const show = !activeFilter || (chip && chip.classList.contains('imam-' + activeFilter));
      tr.classList.toggle('filtered-out', !show);
    });
    document.querySelectorAll('#mobile-cards .day-card-mobile').forEach(card => {
      const chip = card.querySelector('.imam-chip');
      const show = !activeFilter || (chip && chip.classList.contains('imam-' + activeFilter));
      card.classList.toggle('filtered-out', !show);
    });

    // Animate visible rows in with stagger
    const visibleRows = [...document.querySelectorAll('#table-body tr:not(.filtered-out)')];
    const visibleCards = [...document.querySelectorAll('#mobile-cards .day-card-mobile:not(.filtered-out)')];
    const total = visibleRows.length + visibleCards.length;
    const lastDelay = Math.max(
      visibleRows.length ? (visibleRows.length - 1) * 45 + 320 : 0,
      visibleCards.length ? (visibleCards.length - 1) * 55 + 320 : 0
    );

    visibleRows.forEach((tr, i) => {
      tr.style.opacity = '0';
      tr.style.transform = 'translateY(8px)';
      tr.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
      setTimeout(() => {
        tr.style.opacity = '1';
        tr.style.transform = 'translateY(0)';
        setTimeout(() => {
          tr.style.transition = 'background .15s';
          tr.style.opacity = '';
          tr.style.transform = '';
        }, 320);
      }, i * 45);
    });

    visibleCards.forEach((card, i) => {
      card.style.opacity = '0';
      card.style.transform = 'translateY(10px)';
      card.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
      setTimeout(() => {
        card.style.opacity = '1';
        card.style.transform = 'translateY(0)';
        setTimeout(() => {
          card.style.transition = '';
          card.style.opacity = '';
          card.style.transform = '';
        }, 320);
      }, i * 55);
    });

    // Release lock after all animations are done
    setTimeout(() => {
      document.body.style.width = '';
      document.body.style.overflowY = '';
    }, lastDelay + 50);
  }
</script>
</body>
</html>
