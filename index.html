<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tarawih Schema — Kämpingehallen | Ramadan 2026</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;500;600;700&family=DM+Sans:wght@300;400;500;600&family=Share+Tech+Mono&display=swap" rel="stylesheet" />
  <link href="https://fonts.cdnfonts.com/css/digital-7-mono" rel="stylesheet">
  <style>
    /* ── IMAM COLOURS — unchanged in both themes ── */
    :root {
      --gold: #c9a84c;
      --gold-light: #e8c97a;
      --today-green: #3dba7e;
      --abdurrahman: #e8630a;
      --saed: #d4a800;
      --noor: #2980b9;
      --abdul: #2c2c2c;
      --mohammed: #219150;
      --yacquub: #7d3aac;
      --abdelsalam: #7b3f00;
      --hatem: #2d6a4f;
      --ibrahim: #1a3a6b;

      --bg:              #f7f4ef;
      --surface:         #ffffff;
      --surface-2:       #f0ece4;
      --border:          rgba(36,100,93,0.10);
      --border-subtle:   rgba(36,100,93,0.07);
      --text:            #1a1a1a;
      --muted:           #6b7280;
      --muted-2:         #9ca3af;
      --primary:         #24645d;
      --primary-dark:    #1a4a44;
      --today-bg:        #e8f7f0;
      --row-hover:       rgba(36,100,93,0.04);
      --chip-bg:         #ffffff;
      --chip-shadow:     0 2px 8px rgba(0,0,0,0.06);
      --table-shadow:    0 6px 32px rgba(36,100,93,0.12);
      --card-shadow:     0 2px 4px rgba(0,0,0,0.04), 0 8px 24px rgba(36,100,93,0.10), 0 24px 48px rgba(36,100,93,0.06);
      --mobile-shadow:   0 2px 12px rgba(36,100,93,0.08);
      --info-gap:        rgba(36,100,93,0.07);
      --cell-bg:         #ffffff;
      --countdown-bg:    rgba(36,100,93,0.04);
      --countdown-bdr:   rgba(36,100,93,0.09);
      --notif-border:    rgba(36,100,93,0.20);
      --seek-bg:         rgba(0,0,0,0.10);
      --seek-fill:       #1a4a44;
      --scrubber-notch:  #1a4a44;
      --thumb-border:    #ffffff;
      --player-bg:       #ffffff;
      --player-border:   rgba(36,100,93,0.10);
      --player-shadow:   0 -6px 32px rgba(0,0,0,0.11);
      --mini-bg:         rgba(255,255,255,0.96);
      --dcm-pages-bg:    rgba(36,100,93,0.08);
      --dcm-surahs-bg:   rgba(36,100,93,0.06);
      --fredag-clr:      #b45309;
      --lordag-clr:      #1a4a44;
      --header-bg:       #24645d;
      --header-a-bg:     #ffffff;
      --header-a-clr:    #1a4a44;
      --wave-fill:       #24645d;
      --footer-bg:       #1a4a44;
      --legend-bg:       #ffffff;
      /* iPhone toggle light */
      --ios-track-off:   #e5e5ea;
      --ios-track-on:    #34c759;
      --ios-thumb:       #ffffff;
    }

    [data-theme="dark"] {
      --bg:              #0f1614;
      --surface:         #1a2420;
      --surface-2:       #222e2a;
      --border:          rgba(255,255,255,0.07);
      --border-subtle:   rgba(255,255,255,0.05);
      --text:            #e8e3db;
      --muted:           #8a9490;
      --muted-2:         #5a6662;
      --primary:         #2d7a72;
      --primary-dark:    #3a9088;
      --today-bg:        rgba(45,122,114,0.18);
      --row-hover:       rgba(255,255,255,0.03);
      --chip-bg:         #1e2c28;
      --chip-shadow:     0 2px 8px rgba(0,0,0,0.30);
      --table-shadow:    0 6px 32px rgba(0,0,0,0.40);
      --card-shadow:     0 2px 4px rgba(0,0,0,0.20), 0 8px 24px rgba(0,0,0,0.30), 0 24px 48px rgba(0,0,0,0.20);
      --mobile-shadow:   0 2px 12px rgba(0,0,0,0.30);
      --info-gap:        rgba(255,255,255,0.06);
      --cell-bg:         #1a2420;
      --countdown-bg:    rgba(255,255,255,0.04);
      --countdown-bdr:   rgba(255,255,255,0.08);
      --notif-border:    rgba(255,255,255,0.12);
      --seek-bg:         rgba(255,255,255,0.10);
      --seek-fill:       rgba(255,255,255,0.88);
      --scrubber-notch:  rgba(255,255,255,0.90);
      --thumb-border:    #1a2420;
      --player-bg:       #1a2420;
      --player-border:   rgba(255,255,255,0.07);
      --player-shadow:   0 -6px 32px rgba(0,0,0,0.45);
      --mini-bg:         rgba(18,28,24,0.97);
      --dcm-pages-bg:    rgba(255,255,255,0.07);
      --dcm-surahs-bg:   rgba(255,255,255,0.05);
      --fredag-clr:      #e09840;
      --lordag-clr:      #7ecec8;
      --header-bg:       linear-gradient(145deg, rgba(10,26,20,0.99) 0%, rgba(14,36,28,0.99) 40%, rgba(18,48,38,0.99) 70%, rgba(24,64,54,0.99) 100%);
      --header-a-bg:     rgba(255,255,255,0.10);
      --header-a-clr:    rgba(255,255,255,0.88);
      --wave-fill:       #131f1b;
      --footer-bg:       #0d1714;
      --legend-bg:       #1e2c28;
      /* iPhone toggle dark */
      --ios-track-off:   #3a3a3c;
      --ios-track-on:    #30d158;
      --ios-thumb:       #ffffff;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { background: var(--bg); font-family: 'DM Sans', sans-serif; color: var(--text); -webkit-text-size-adjust: 100%; transition: background 0.35s ease, color 0.35s ease; }

    /* ══════════════════════════════════════════════
       EXACT IMAGE TOGGLE — wide pill, label inside, dark circle thumb
    ══════════════════════════════════════════════ */
    .theme-toggle {
      position: absolute; top: 10px; right: 12px; z-index: 10;
      display: inline-flex; align-items: center;
      background: none; border: none; padding: 0;
      cursor: pointer; font-family: inherit;
      -webkit-tap-highlight-color: transparent;
    }

    /* The wide pill track */
    .ios-track {
      position: relative;
      width: 76px;
      height: 30px;
      border-radius: 999px;
      background: #e8e8e8;
      box-shadow:
        0 3px 8px rgba(0,0,0,0.30),
        inset 0 1px 2px rgba(255,255,255,0.6),
        inset 0 -1px 2px rgba(0,0,0,0.12);
      flex-shrink: 0;
      transition: background 0.38s cubic-bezier(0.4,0,0.2,1),
                  box-shadow 0.38s ease;
      overflow: hidden;
    }
    [data-theme="dark"] .ios-track {
      background: #1c1c1e;
      box-shadow:
        0 3px 8px rgba(0,0,0,0.50),
        inset 0 1px 3px rgba(255,255,255,0.04),
        inset 0 -1px 3px rgba(0,0,0,0.5);
    }

    /* Label text inside the track — centred in the gap opposite the thumb */
    .ios-track-label {
      position: absolute;
      top: 50%;
      /* Light mode: thumb on right (occupies 49–76px). Centre of left zone (0–49px) = 24.5px */
      left: 0;
      right: calc(24px + 3px);   /* keep label out of thumb zone */
      transform: translateY(-50%);
      font-size: 0.38rem;
      font-weight: 800;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      line-height: 1.2;
      text-align: center;
      pointer-events: none;
      white-space: nowrap;
      user-select: none;
      color: rgba(70,70,70,0.80);
      transition: color 0.3s ease, left 0s, right 0s;
    }
    [data-theme="dark"] .ios-track-label {
      /* Dark mode: thumb on left (occupies 3–27px). Centre of right zone (27–76px). */
      left: calc(24px + 3px);
      right: 0;
      color: rgba(160,160,160,0.70);
    }

    /* Dark circle thumb */
    .ios-thumb {
      position: absolute;
      top: 3px;
      left: calc(100% - 3px - 24px);
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: radial-gradient(circle at 38% 35%, #4a4a4a, #1a1a1a);
      box-shadow:
        0 2px 6px rgba(0,0,0,0.50),
        0 1px 2px rgba(0,0,0,0.35),
        inset 0 1px 1px rgba(255,255,255,0.08);
      transition:
        left 0.38s cubic-bezier(0.34,1.45,0.64,1),
        width 0.10s ease;
      will-change: left;
      z-index: 2;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    [data-theme="dark"] .ios-thumb {
      left: 3px;
      background: radial-gradient(circle at 38% 35%, #555, #222);
    }
    /* Icon inside thumb — cross-dissolve between sun and moon */
    .ios-thumb-icon {
      position: absolute;
      display: flex; align-items: center; justify-content: center;
      transition: opacity 0.28s ease, transform 0.32s cubic-bezier(0.34,1.56,0.64,1);
    }
    .ios-thumb-sun  { opacity: 1;  transform: scale(1)   rotate(0deg); }
    .ios-thumb-moon { opacity: 0;  transform: scale(0.5) rotate(-30deg); }
    [data-theme="dark"] .ios-thumb-sun  { opacity: 0;  transform: scale(0.5) rotate(30deg); }
    [data-theme="dark"] .ios-thumb-moon { opacity: 1;  transform: scale(1)   rotate(0deg); }

    /* Squish on press */
    .theme-toggle:active .ios-thumb {
      width: 28px;
    }
    [data-theme="dark"] .theme-toggle:active .ios-thumb {
      width: 28px;
      left: 3px;
    }

    /* ── HEADER ── */
    header { background: var(--header-bg); padding: 28px 20px 22px; text-align: center; position: relative; overflow: hidden; transition: background 0.35s ease; }
    header::before { content: ''; position: absolute; inset: 0; background: radial-gradient(ellipse at 15% 60%, rgba(201,168,76,0.14) 0%, transparent 55%); pointer-events: none; }
    [data-theme="dark"] header::before { background: radial-gradient(ellipse at 80% 25%, rgba(201,168,76,0.09) 0%, transparent 55%), radial-gradient(ellipse at 15% 70%, rgba(36,100,93,0.18) 0%, transparent 40%); }
    .ornament { display: flex; align-items: center; justify-content: center; gap: 12px; margin-bottom: 20px; position: relative; z-index: 2; }
    .orn-line { height: 1px; width: 50px; }
    .orn-line.l { background: linear-gradient(to right, transparent, var(--gold)); }
    .orn-line.r { background: linear-gradient(to left, transparent, var(--gold)); }
    .orn-diamond { width: 7px; height: 7px; background: var(--gold); transform: rotate(45deg); }
    .orn-dot { width: 3px; height: 3px; background: var(--gold-light); border-radius: 50%; }
    header h1 { font-family: 'Cormorant Garamond', serif; font-size: clamp(1.8rem, 6vw, 3.2rem); font-weight: 600; color: #ffffff; letter-spacing: .03em; line-height: 1.2; position: relative; z-index: 2; }
    .header-address { margin-top: 20px; position: relative; z-index: 2; display: flex; flex-direction: column; align-items: center; gap: 10px; }
    .header-address .addr-text { display: flex; align-items: center; gap: 6px; color: rgba(255,255,255,.65); font-size: .82rem; }
    .header-address a { display: inline-flex; align-items: center; gap: 6px; background: var(--header-a-bg); color: var(--header-a-clr); font-size: .75rem; font-weight: 600; letter-spacing: .08em; text-transform: uppercase; padding: 7px 18px; border-radius: 30px; text-decoration: none; box-shadow: 0 2px 12px rgba(0,0,0,.15); transition: background 0.35s, color 0.35s; }
    .wave { background: var(--header-bg); line-height: 0; transition: background 0.35s; }
    .wave svg { display: block; width: 100%; }

    /* ── MAIN ── */
    main { max-width: 960px; margin: 0 auto; padding: 32px 14px 80px; }

    /* ═══════════════════════════════════════════════════
       TODAY CARD
    ═══════════════════════════════════════════════════ */
    .today-card {
      display: none;
      background: var(--surface);
      border-radius: 22px;
      border: 1px solid var(--border);
      box-shadow: var(--card-shadow);
      overflow: hidden;
      margin-bottom: 32px;
      transition: background 0.35s, border-color 0.35s, box-shadow 0.35s;
    }

    .today-card-top {
      position: relative;
      padding: 22px 28px 20px;
      background: linear-gradient(145deg, rgba(15,40,50,0.97) 0%, rgba(20,58,52,0.97) 40%, rgba(26,74,68,0.95) 70%, rgba(36,100,93,0.93) 100%);
      overflow: hidden;
    }
    .today-card-top::before {
      content: '';
      position: absolute; inset: 0;
      background: radial-gradient(ellipse at 80% 20%, rgba(201,168,76,0.08) 0%, transparent 55%),
                  radial-gradient(ellipse at 20% 80%, rgba(36,100,93,0.15) 0%, transparent 45%);
      pointer-events: none;
    }
    .today-card-top::after {
      content: ''; position: absolute; inset: 0; opacity: 0.025;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
      background-size: 128px; pointer-events: none;
    }

    .today-badge-pill {
      position: relative; z-index: 2;
      display: inline-flex; align-items: center; gap: 5px;
      background: rgba(201,168,76,0.15); border: 1px solid rgba(201,168,76,0.30);
      border-radius: 100px; padding: 4px 12px; margin-bottom: 10px;
    }
    .today-badge-pill-dot { width: 5px; height: 5px; border-radius: 50%; background: var(--gold-light); flex-shrink: 0; box-shadow: 0 0 5px rgba(201,168,76,0.6); }
    .today-badge-pill-text { font-size: 0.60rem; font-weight: 600; letter-spacing: 0.14em; text-transform: uppercase; color: var(--gold-light); }
    .today-card-header-content { position: relative; z-index: 2; }
    .today-imam-name { font-family: 'Cormorant Garamond', serif; font-size: clamp(1.65rem, 5vw, 2.2rem); font-weight: 600; color: #ffffff; line-height: 1.1; letter-spacing: 0.01em; margin-bottom: 6px; display: block; }
    .today-date-row { display: flex; align-items: center; gap: 8px; }
    .today-date-text { font-size: 0.82rem; color: rgba(255,255,255,0.55); font-weight: 400; letter-spacing: 0.02em; }

    .today-moon-wrap { position: relative; display: inline-flex; align-items: center; }
    .today-moon-icon {
      display: inline-flex; align-items: center; justify-content: center;
      width: 22px; height: 22px; border-radius: 50%;
      background: rgba(15, 45, 94, 0.5);
      border: 1.5px solid rgba(255,255,255,0.2);
      cursor: default;
      animation: moonPulseBlue 2s ease-in-out infinite;
    }
    .today-moon-icon.moon-odd-today {
      background: linear-gradient(135deg, #9a6f0a, #c9a84c);
      border-color: rgba(255,220,100,0.4);
      animation: moonGlow 2.2s ease-in-out infinite;
    }
    @keyframes moonPulseBlue {
      0%, 100% { box-shadow: 0 0 0 0 rgba(58,123,213,0.5); }
      50% { box-shadow: 0 0 0 6px rgba(58,123,213,0); }
    }
    @keyframes moonGlow {
      0%,100% {
        box-shadow: 0 0 4px 1px rgba(201,168,76,0.6), 0 0 10px 2px rgba(201,168,76,0.35), 0 0 22px 4px rgba(201,168,76,0.15);
      }
      50% {
        box-shadow: 0 0 8px 3px rgba(232,201,122,0.85), 0 0 18px 6px rgba(201,168,76,0.55), 0 0 36px 10px rgba(201,168,76,0.22);
      }
    }

    .today-moon-tooltip {
      position: absolute;
      bottom: calc(100% + 8px); left: 50%;
      transform: translateX(-50%) translateY(4px);
      width: 240px;
      background: #12211f;
      border: 1px solid rgba(201,168,76,0.40);
      box-shadow: 0 8px 28px rgba(0,0,0,0.35);
      color: rgba(255,255,255,0.88);
      font-size: .72rem; line-height: 1.55;
      padding: 10px 12px; border-radius: 10px;
      z-index: 200; pointer-events: none; font-style: italic;
      opacity: 0; visibility: hidden;
      transition: opacity 0.35s ease, visibility 0.35s ease, transform 0.35s ease;
    }
    .today-moon-tooltip::before {
      content: '';
      position: absolute; top: 0; left: 12px; right: 12px; height: 1px;
      background: linear-gradient(to right, transparent, rgba(201,168,76,0.5), transparent);
    }
    .today-moon-tooltip::after {
      content: ''; position: absolute; top: 100%; left: 50%;
      transform: translateX(-50%);
      border-left: 6px solid transparent; border-right: 6px solid transparent;
      border-top: 6px solid #12211f;
    }
    .today-moon-wrap:hover .today-moon-tooltip,
    .today-moon-wrap.active .today-moon-tooltip {
      opacity: 1; visibility: visible; transform: translateX(-50%) translateY(0);
    }

    .today-card-body { padding: 16px 28px 20px; display: flex; flex-direction: column; gap: 0; background: var(--surface); transition: background 0.35s; }
    .today-info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1px; background: var(--info-gap); border-radius: 14px; overflow: hidden; margin-bottom: 14px; transition: background 0.35s; }
    .today-info-cell { background: var(--cell-bg); padding: 12px 16px; transition: background 0.35s; }
    .today-info-cell:first-child { border-radius: 14px 0 0 14px; }
    .today-info-cell:last-child  { border-radius: 0 14px 14px 0; }
    @media (max-width: 480px) {
      .today-info-grid { grid-template-columns: 1fr; }
      .today-info-cell:first-child { border-radius: 14px 14px 0 0; }
      .today-info-cell:last-child  { border-radius: 0 0 14px 14px; }
    }
    .today-info-label { font-size: 0.60rem; font-weight: 600; letter-spacing: 0.13em; text-transform: uppercase; color: var(--muted); display: block; margin-bottom: 5px; transition: color 0.35s; }
    .today-info-value { font-family: 'Cormorant Garamond', serif; font-size: 1.35rem; font-weight: 600; color: var(--primary-dark); line-height: 1.2; display: block; transition: color 0.35s; }
    .today-info-sub { font-size: 0.75rem; color: var(--muted); margin-top: 3px; display: block; line-height: 1.4; transition: color 0.35s; }

    .today-countdown-section { display: none; background: var(--countdown-bg); border: 1px solid var(--countdown-bdr); border-radius: 14px; padding: 13px 16px; margin-bottom: 14px; transition: background 0.8s ease, border-color 0.8s ease, box-shadow 0.8s ease; }
    .today-countdown-section.isha-done { background: rgba(36,186,120,0.08); border-color: rgba(36,186,120,0.25); }
    @keyframes ishaGlow { 0% { box-shadow: 0 0 0 0 rgba(61,186,126,0); } 20% { box-shadow: 0 0 0 8px rgba(61,186,126,0.18); } 50% { box-shadow: 0 0 0 16px rgba(61,186,126,0.08); } 80% { box-shadow: 0 0 0 8px rgba(61,186,126,0.12); } 100% { box-shadow: 0 0 0 0 rgba(61,186,126,0); } }
    .today-countdown-section.isha-pulsing { animation: ishaGlow 1.6s ease-out 3; }
    .today-countdown-inner { display: flex; align-items: center; justify-content: space-between; gap: 12px; }
    .today-countdown-left { flex: 1; min-width: 0; }
    .today-countdown-label { font-size: 0.60rem; font-weight: 600; letter-spacing: 0.13em; text-transform: uppercase; color: var(--muted); display: block; margin-bottom: 6px; transition: color 0.6s ease; }
    .isha-done .today-countdown-label { color: #1d7a4e; }
    .timer-wrap { position: relative; min-height: 2.2rem; display: flex; align-items: center; }
    .today-timer { font-family: 'Digital-7 Mono', 'Digital-7', monospace; font-size: 2.0rem; font-weight: 400; color: var(--primary-dark); letter-spacing: 0.05em; line-height: 1; transition: opacity 0.5s ease, transform 0.5s ease, color 0.35s; }
    .today-timer.fading-out { opacity: 0; transform: translateY(-6px); pointer-events: none; }
    .today-timer-done { position: absolute; left: 0; font-family: 'DM Sans', sans-serif; font-size: 1.05rem; font-weight: 600; color: #1d7a4e; opacity: 0; transform: translateY(6px); transition: opacity 0.5s ease 0.3s, transform 0.5s ease 0.3s; white-space: nowrap; }
    .today-timer-done.fading-in { opacity: 1; transform: translateY(0); }
    .today-countdown-sub { font-size: 0.72rem; color: var(--muted); margin-top: 6px; display: block; transition: color 0.6s ease; }
    .isha-done .today-countdown-sub { color: #2d9e6b; }

    .notif-btn { display: inline-flex; align-items: center; gap: 6px; background: none; border: 1px solid var(--notif-border); border-radius: 100px; padding: 5px 12px; font-size: 0.68rem; font-weight: 500; font-family: inherit; color: var(--muted); cursor: pointer; white-space: nowrap; transition: border-color 0.2s, color 0.2s, background 0.2s; flex-shrink: 0; align-self: flex-start; }
    .notif-btn:hover { border-color: var(--primary); color: var(--primary-dark); background: var(--row-hover); }
    .notif-btn.granted { border-color: rgba(36,186,120,0.35); color: #1d7a4e; background: rgba(36,186,120,0.06); cursor: default; pointer-events: none; }
    .notif-btn.denied { opacity: 0.4; cursor: not-allowed; pointer-events: none; }

    .today-card-footer { display: flex; align-items: center; justify-content: flex-end; }
    .today-scroll-btn { display: inline-flex; align-items: center; gap: 7px; background: var(--primary-dark); color: #fff; font-size: 0.72rem; font-weight: 600; letter-spacing: 0.10em; text-transform: uppercase; padding: 10px 20px; border-radius: 100px; border: none; cursor: pointer; font-family: inherit; white-space: nowrap; box-shadow: 0 2px 12px rgba(26,74,68,0.25); transition: box-shadow 0.2s ease, transform 0.2s ease, background 0.2s ease; }
    .today-scroll-btn:hover { background: var(--primary); box-shadow: 0 4px 20px rgba(26,74,68,0.35); transform: translateY(-1px); }

    .today-hadith-inline {
      position: relative; z-index: 2;
      margin-top: 12px;
      padding: 10px 12px;
      background: rgba(201,168,76,0.07);
      border-left: 2px solid rgba(201,168,76,0.45);
      border-radius: 0 8px 8px 0;
      font-size: 0.70rem;
      color: rgba(255,255,255,0.50);
      font-style: italic;
      line-height: 1.6;
    }
    .today-hadith-inline .hadith-label {
      display: block;
      font-size: 0.55rem;
      font-weight: 700;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      color: rgba(201,168,76,0.65);
      margin-bottom: 4px;
      font-style: normal;
    }

    @keyframes cardPulse {
      0%   { box-shadow: 0 2px 4px rgba(0,0,0,.04), 0 8px 24px rgba(36,100,93,.10), 0 24px 48px rgba(36,100,93,.06), 0 0 0 0 var(--card-pulse, rgba(255,255,255,0.3)); }
      40%  { box-shadow: 0 2px 4px rgba(0,0,0,.04), 0 8px 24px rgba(36,100,93,.10), 0 24px 48px rgba(36,100,93,.06), 0 0 0 14px rgba(0,0,0,0); }
      66%  { box-shadow: 0 2px 4px rgba(0,0,0,.04), 0 8px 24px rgba(36,100,93,.10), 0 24px 48px rgba(36,100,93,.06), 0 0 0 0 rgba(0,0,0,0); }
      100% { box-shadow: 0 2px 4px rgba(0,0,0,.04), 0 8px 24px rgba(36,100,93,.10), 0 24px 48px rgba(36,100,93,.06), 0 0 0 0 rgba(0,0,0,0); }
    }
    .today-card.pulsing { animation: cardPulse 3s ease-out infinite; animation-delay: 0.5s; }

    /* ── EID CARD ── */
    .eid-card { display: none; position: relative; border-radius: 24px; padding: 52px 32px 44px; text-align: center; margin-bottom: 32px; overflow: hidden; background: linear-gradient(160deg, #0a1f3d 0%, #0f2d40 25%, #163d38 55%, #1a4a44 80%, #24645d 100%); box-shadow: 0 2px 4px rgba(0,0,0,0.08), 0 12px 40px rgba(10,31,61,0.35), 0 32px 64px rgba(10,31,61,0.18); border: 1px solid rgba(201,168,76,0.12); animation: eidFadeUp 1.1s cubic-bezier(0.22,1,0.36,1) both; }
    @keyframes eidFadeUp { from { opacity: 0; transform: translateY(28px); } to { opacity: 1; transform: translateY(0); } }
    .eid-card::before { content: ''; position: absolute; inset: 0; background: radial-gradient(ellipse at 15% 20%, rgba(201,168,76,0.13) 0%, transparent 50%), radial-gradient(ellipse at 85% 80%, rgba(36,100,93,0.25) 0%, transparent 45%), radial-gradient(ellipse at 50% 50%, rgba(15,45,64,0.3) 0%, transparent 70%); pointer-events: none; }
    .eid-card::after { content: ''; position: absolute; inset: 0; opacity: 0.03; background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E"); background-size: 128px; pointer-events: none; }
    .eid-inner { position: relative; z-index: 2; }
    .eid-ornament { display: flex; align-items: center; justify-content: center; gap: 10px; margin-bottom: 28px; animation: eidFadeUp 1.1s 0.15s cubic-bezier(0.22,1,0.36,1) both; }
    .eid-orn-line { height: 1px; width: 44px; background: linear-gradient(to right, transparent, rgba(201,168,76,0.6)); }
    .eid-orn-line.r { background: linear-gradient(to left, transparent, rgba(201,168,76,0.6)); }
    .eid-orn-diamond { width: 6px; height: 6px; background: var(--gold); transform: rotate(45deg); }
    .eid-orn-dot { width: 3px; height: 3px; background: var(--gold-light); border-radius: 50%; }
    .eid-arabic { font-family: 'Cormorant Garamond', serif; font-size: clamp(1.6rem, 5vw, 2.2rem); font-weight: 500; color: rgba(255,255,255,0.92); letter-spacing: 0.04em; line-height: 1.4; margin-bottom: 6px; direction: rtl; animation: eidFadeUp 1.1s 0.25s cubic-bezier(0.22,1,0.36,1) both; }
    .eid-title { font-family: 'Cormorant Garamond', serif; font-size: clamp(2.6rem, 8vw, 4rem); font-weight: 700; color: #fff; line-height: 1.05; letter-spacing: 0.01em; margin-bottom: 10px; background: linear-gradient(105deg, #fff 0%, #fff 35%, var(--gold-light) 50%, #fff 65%, #fff 100%); background-size: 200% auto; -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; animation: eidFadeUp 1.1s 0.35s cubic-bezier(0.22,1,0.36,1) both, eidShimmer 4s 1.5s ease-in-out infinite; }
    @keyframes eidShimmer { 0% { background-position: 200% center; } 50% { background-position: -50% center; } 100% { background-position: 200% center; } }
    .eid-divider { display: flex; align-items: center; justify-content: center; gap: 8px; margin: 16px 0 18px; animation: eidFadeUp 1.1s 0.45s cubic-bezier(0.22,1,0.36,1) both; }
    .eid-divider-line { height: 1px; width: 36px; background: rgba(201,168,76,0.45); }
    .eid-divider-dot  { width: 4px; height: 4px; background: var(--gold); transform: rotate(45deg); }
    .eid-subtitle { font-size: 0.88rem; color: rgba(255,255,255,0.55); font-style: italic; letter-spacing: 0.06em; line-height: 1.6; animation: eidFadeUp 1.1s 0.52s cubic-bezier(0.22,1,0.36,1) both; }
    .eid-note { margin-top: 28px; padding-top: 22px; border-top: 1px solid rgba(255,255,255,0.08); font-size: 0.78rem; color: rgba(255,255,255,0.38); letter-spacing: 0.03em; line-height: 1.7; animation: eidFadeUp 1.1s 0.62s cubic-bezier(0.22,1,0.36,1) both; }
    .eid-note strong { color: rgba(255,255,255,0.55); font-weight: 500; }
    .eid-instagram { display: inline-flex; align-items: center; gap: 7px; margin-top: 18px; color: rgba(255,255,255,0.45); font-size: 0.76rem; text-decoration: none; letter-spacing: 0.04em; transition: color 0.2s; animation: eidFadeUp 1.1s 0.70s cubic-bezier(0.22,1,0.36,1) both; }
    .eid-instagram:hover { color: rgba(255,255,255,0.75); }
    .eid-crescents { position: absolute; inset: 0; pointer-events: none; overflow: hidden; }
    .eid-crescent { position: absolute; font-size: 1.1rem; opacity: 0; animation: eidFloat var(--dur, 6s) var(--delay, 0s) ease-in-out infinite; }
    @keyframes eidFloat { 0% { opacity: 0; transform: translateY(0) rotate(var(--rot,0deg)) scale(0.8); } 15% { opacity: var(--max-op, 0.18); } 85% { opacity: var(--max-op, 0.18); } 100% { opacity: 0; transform: translateY(-30px) rotate(var(--rot,15deg)) scale(1); } }

    /* ── SECTION TITLE ── */
    .section-title { text-align: center; margin-bottom: 20px; }
    .section-title h2 { font-family: 'Cormorant Garamond', serif; font-size: clamp(1.3rem, 4vw, 1.9rem); font-weight: 600; color: var(--primary-dark); transition: color 0.35s; }
    .divider { display: flex; align-items: center; justify-content: center; gap: 10px; margin-top: 10px; }
    .divider span { height: 1px; width: 40px; background: var(--gold); display: block; }
    .divider i { width: 5px; height: 5px; background: var(--gold); transform: rotate(45deg); display: block; }

    /* ── LEGEND ── */
    .legend { display: flex; flex-wrap: wrap; gap: 8px; justify-content: center; margin-bottom: 20px; }
    .legend-item { display: flex; align-items: center; gap: 6px; background: var(--legend-bg); border-radius: 30px; padding: 5px 12px 5px 8px; box-shadow: var(--chip-shadow); font-size: .78rem; font-weight: 500; color: var(--text); transition: background 0.35s, color 0.35s, box-shadow 0.35s; }
    .legend-dot { width: 10px; height: 10px; border-radius: 50%; flex-shrink: 0; }

    /* ── TABLE ── */
    .table-wrap { overflow-x: auto; border-radius: 16px; box-shadow: var(--table-shadow); transition: box-shadow 0.35s; }
    table { width: 100%; border-collapse: collapse; background: var(--surface); font-size: .875rem; transition: background 0.35s; }
    thead tr { background: var(--primary); transition: background 0.35s; }
    thead th { font-size: .7rem; font-weight: 500; text-transform: uppercase; letter-spacing: .1em; color: rgba(255,255,255,.7); padding: 14px 16px; text-align: left; white-space: nowrap; }
    tbody tr { border-bottom: 1px solid var(--border-subtle); transition: background .15s; border-left: 4px solid transparent; }
    tbody tr:last-child { border-bottom: none; }
    tbody tr:hover { background: var(--row-hover); }
    tbody tr.today { background: var(--today-bg) !important; border-left-color: var(--today-green); }
    td { padding: 12px 16px; vertical-align: middle; }
    .td-dag { font-weight: 700; font-size: .95rem; color: var(--primary-dark); text-align: center; transition: color 0.35s; }
    .td-sidor { font-size: .8rem; color: var(--muted); white-space: nowrap; transition: color 0.35s; }
    .td-surah { font-size: .78rem; color: var(--primary-dark); max-width: 240px; line-height: 1.4; }
    .td-datum { font-size: .8rem; color: var(--muted); white-space: nowrap; transition: color 0.35s; }
    .td-datum.today-date { color: #1d7a4e; font-weight: 600; }
    .td-veckodag { font-size: .8rem; font-weight: 500; white-space: nowrap; transition: color 0.35s; }
    .fredag { color: var(--fredag-clr); font-weight: 700; }
    .lordag { color: var(--lordag-clr); }
    .sondag { color: var(--fredag-clr); }
    .imam-chip { display: inline-flex; align-items: center; gap: 6px; padding: 4px 11px 4px 8px; border-radius: 30px; font-size: .78rem; font-weight: 500; color: #fff; white-space: nowrap; }
    .imam-chip .dot { width: 6px; height: 6px; border-radius: 50%; background: rgba(255,255,255,.35); flex-shrink: 0; }
    .imam-abdurrahman { background: var(--abdurrahman); }
    .imam-saed { background: var(--saed); color: #1a1a1a !important; }
    .imam-saed .dot { background: rgba(0,0,0,.15) !important; }
    .imam-noor { background: #f0ede8; color: #1a1a1a !important; }
    .imam-noor .dot { background: rgba(0,0,0,.15) !important; }
    .imam-abdul { background: var(--abdul); }
    .imam-mohammed { background: var(--mohammed); }
    .imam-yacquub { background: var(--yacquub); }
    .imam-abdelsalam { background: var(--abdelsalam); }
    .imam-hatem { background: var(--hatem); }
    .imam-ibrahim { background: var(--ibrahim); }
    .today-badge { display: inline-block; background: var(--today-green); color: #fff; font-size: .6rem; font-weight: 700; text-transform: uppercase; letter-spacing: .08em; padding: 2px 6px; border-radius: 8px; margin-left: 5px; vertical-align: middle; }

    /* ── TOOLTIP (surah) ── */
    .surah-cell { position: relative; cursor: pointer; }
    .surah-names { font-size: .78rem; color: var(--primary-dark); line-height: 1.5; transition: color 0.35s; }

    @keyframes tooltipSlideUp {
      0%   { opacity: 0; transform: translateY(10px) scale(0.97); }
      60%  { opacity: 1; transform: translateY(-2px) scale(1.01); }
      100% { opacity: 1; transform: translateY(0) scale(1); }
    }
    @keyframes tooltipSlideDown {
      0%   { opacity: 1; transform: translateY(0) scale(1); }
      100% { opacity: 0; transform: translateY(8px) scale(0.97); }
    }

    .tooltip-box {
      display: none;
      position: absolute;
      left: 0; top: calc(100% + 8px);
      background: #12211f;
      border: 1px solid rgba(201,168,76,0.40);
      color: rgba(255,255,255,0.88);
      font-size: .75rem; font-weight: 400; font-style: italic;
      padding: 9px 14px; border-radius: 10px;
      white-space: nowrap; z-index: 100;
      box-shadow: 0 8px 28px rgba(0,0,0,0.35);
      letter-spacing: .02em; pointer-events: none;
      transform-origin: top left;
    }
    .tooltip-box::before { display: none; }
    .tooltip-box::after { display: none; }
    @media (hover: hover) {
      .surah-cell:hover .tooltip-box {
        display: block;
        animation: tooltipSlideUp 0.38s cubic-bezier(0.34,1.56,0.64,1) forwards;
      }
    }
    .tooltip-box.visible {
      display: block;
      animation: tooltipSlideUp 0.38s cubic-bezier(0.34,1.56,0.64,1) forwards;
    }

    /* ══════════════════════════════════════════
       CHANGE 1 — Moon tooltip: full-width slide-up on mobile
    ══════════════════════════════════════════ */
    @keyframes moonTooltipSlideUp {
      0%   { opacity: 0; transform: translateY(20px) scale(0.96); }
      60%  { opacity: 1; transform: translateY(-3px) scale(1.01); }
      100% { opacity: 1; transform: translateY(0) scale(1); }
    }
    @keyframes moonTooltipSlideDown {
      0%   { opacity: 1; transform: translateY(0) scale(1); }
      100% { opacity: 0; transform: translateY(14px) scale(0.96); }
    }

    @media (max-width: 640px) {
      /* Overlay backdrop */
      .moon-tooltip-backdrop {
        display: none;
        position: fixed; inset: 0;
        background: rgba(0,0,0,0.45);
        z-index: 998;
        backdrop-filter: blur(2px);
        -webkit-backdrop-filter: blur(2px);
        animation: fadeIn 0.25s ease forwards;
      }
      @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
      .moon-tooltip-backdrop.visible { display: block; }
      .moon-tooltip-backdrop.hiding  { animation: fadeOut 0.25s ease forwards; }
      @keyframes fadeOut { from { opacity: 1; } to { opacity: 0; } }

      /* Override existing moon-tooltip on mobile */
      .moon-tooltip,
      .today-moon-tooltip {
        position: fixed !important;
        bottom: 0 !important; left: 0 !important; right: 0 !important;
        top: auto !important;
        width: 100% !important;
        max-width: 100% !important;
        transform: none !important;
        border-radius: 22px 22px 0 0 !important;
        padding: 20px 22px 32px !important;
        font-size: 0.88rem !important;
        line-height: 1.7 !important;
        z-index: 999 !important;
        pointer-events: auto !important;
        visibility: hidden;
        opacity: 0;
        transition: none !important;
      }
      .moon-tooltip.visible,
      .today-moon-wrap.active .today-moon-tooltip,
      .moon-wrap.active .moon-tooltip {
        visibility: visible !important;
        opacity: 1 !important;
        animation: moonTooltipSlideUp 0.42s cubic-bezier(0.34,1.56,0.64,1) forwards !important;
      }
      .moon-tooltip.hiding,
      .today-moon-tooltip.hiding {
        animation: moonTooltipSlideDown 0.28s ease forwards !important;
      }

      /* Gold variant on mobile too */
      .moon-tooltip.gold-tooltip,
      .today-moon-tooltip {
        background: #12211f !important;
        border: 1px solid rgba(201,168,76,0.40) !important;
        border-bottom: none !important;
        box-shadow: 0 -8px 40px rgba(0,0,0,0.5) !important;
        color: rgba(255,255,255,0.88) !important;
      }
      /* Handle bar at top */
      .moon-tooltip::before,
      .today-moon-tooltip::before {
        content: '' !important;
        position: absolute !important; top: 10px !important; left: 50% !important;
        transform: translateX(-50%) !important;
        width: 36px !important; height: 4px !important;
        background: rgba(255,255,255,0.25) !important;
        border-radius: 99px !important;
        right: auto !important;
      }
      /* Remove arrow */
      .moon-tooltip::after,
      .today-moon-tooltip::after { display: none !important; }

      /* Hadith label inside mobile tooltip */
      .moon-tooltip-title {
        display: block;
        font-size: 0.60rem;
        font-weight: 700;
        letter-spacing: 0.14em;
        text-transform: uppercase;
        color: rgba(201,168,76,0.80);
        margin-bottom: 10px;
        margin-top: 10px;
        font-style: normal;
      }
    }

    /* ── MOBILE CARDS ── */
    .mobile-cards { display: none; }
    .day-card-mobile { background: var(--surface); border-radius: 14px; padding: 14px 16px; margin-bottom: 10px; box-shadow: var(--mobile-shadow); border-left: 4px solid transparent; transition: background 0.35s, box-shadow 0.35s; }
    .day-card-mobile.today { background: var(--today-bg); border-left-color: var(--today-green); }
    .dcm-top { display: flex; align-items: center; gap: 14px; margin-bottom: 8px; }
    .dcm-audio-right .play-btn { width: 34px; height: 34px; }
    .dcm-audio-right { display: flex; align-items: center; margin-left: auto; flex-shrink: 0; }
    .dcm-dag { font-weight: 700; font-size: 1.3rem; color: var(--primary-dark); min-width: 32px; text-align: center; flex-shrink: 0; transition: color 0.35s; }
    .dcm-dag.today-day { color: #1d7a4e; }
    .dcm-body { flex: 1; min-width: 0; }
    .dcm-imam { margin-bottom: 5px; }
    .dcm-meta { display: flex; align-items: center; gap: 8px; flex-wrap: wrap; }
    .dcm-date { font-size: .75rem; color: var(--muted); transition: color 0.35s; }
    .dcm-day-label { font-size: .75rem; font-weight: 500; }
    .dcm-pages { font-size: .75rem; color: var(--muted); background: var(--dcm-pages-bg); padding: 2px 8px; border-radius: 10px; transition: background 0.35s, color 0.35s; }
    .dcm-surahs { margin-left: 46px; font-size: .78rem; color: var(--primary-dark); background: var(--dcm-surahs-bg); border-radius: 8px; padding: 6px 10px; line-height: 1.5; position: relative; cursor: pointer; transition: background 0.35s, color 0.35s; }
    .dcm-surahs-label { font-size: .65rem; text-transform: uppercase; letter-spacing: .1em; color: var(--muted); display: block; margin-bottom: 2px; transition: color 0.35s; }
    .dcm-tooltip { max-height: 0; overflow: hidden; opacity: 0; margin-top: 0; padding: 0 10px; background: var(--primary-dark); color: #fff; font-size: .75rem; font-weight: 500; border-radius: 7px; letter-spacing: .02em; transition: max-height 0.45s cubic-bezier(0.4,0,0.2,1), opacity 0.35s ease, margin-top 0.35s ease, padding 0.35s ease; }
    .dcm-tooltip.visible { max-height: 80px; opacity: 1; margin-top: 6px; padding: 7px 10px; }

    /* ── LAST 10 NIGHTS ── */
    tbody tr.last-ten { background: var(--surface); }
    tbody tr.last-ten.today { background: #0f2d5e !important; border-left-color: #3a7bd5; }
    [data-theme="dark"] tbody tr.last-ten.today { background: #0a2040 !important; }
    tbody tr.last-ten.today td { color: #fff !important; }
    tbody tr.last-ten.today .td-sidor,
    tbody tr.last-ten.today .td-datum,
    tbody tr.last-ten.today .td-veckodag { color: rgba(255,255,255,0.75) !important; }
    tbody tr.last-ten.today .td-dag { color: #fff !important; }
    tbody tr.last-ten.today .today-date { color: #7eb8f7 !important; }
    tbody tr.last-ten.today .today-badge { background: #3a7bd5; }
    tbody tr.last-ten.today .td-surah .surah-names { color: rgba(255,255,255,0.9) !important; }
    tbody tr.last-ten.today .moon-icon { background: transparent !important; border: 2px solid rgba(255,255,255,0.8); box-shadow: none !important; animation: none !important; }
    .day-card-mobile.last-ten.today .moon-icon { background: transparent !important; border: 2px solid rgba(255,255,255,0.8); box-shadow: none !important; animation: none !important; }

    /* ── MOON ICONS (table) ── */
    .moon-icon { display: inline-flex; align-items: center; justify-content: center; width: 20px; height: 20px; border-radius: 50%; background: #0f2d5e; vertical-align: middle; flex-shrink: 0; }
    .moon-icon.moon-odd { background: linear-gradient(135deg, #9a6f0a, #c9a84c); animation: moonGlow 2.2s ease-in-out infinite; }

    /* ── MOON TOOLTIP (table) ── */
    .moon-wrap { position: relative; display: inline-flex; align-items: center; }
    .moon-tooltip {
      position: absolute;
      bottom: calc(100% + 8px); right: 0;
      width: 240px;
      background: #0f2d5e; color: #fff;
      font-size: .72rem; line-height: 1.55;
      padding: 10px 12px; border-radius: 10px;
      box-shadow: 0 6px 20px rgba(0,0,0,.3);
      z-index: 200; pointer-events: none; font-style: italic;
      opacity: 0; visibility: hidden; transform: translateY(4px);
      transition: opacity 0.35s ease, visibility 0.35s ease, transform 0.35s ease;
    }
    .moon-tooltip::after {
      content: ''; position: absolute; top: 100%; right: 6px;
      border-left: 6px solid transparent; border-right: 6px solid transparent;
      border-top: 6px solid #0f2d5e;
    }
    .moon-wrap:hover .moon-tooltip, .moon-wrap.active .moon-tooltip { opacity: 1; visibility: visible; transform: translateY(0); }

    .moon-tooltip.gold-tooltip {
      background: #12211f;
      border: 1px solid rgba(201,168,76,0.40);
      box-shadow: 0 8px 28px rgba(0,0,0,0.35);
      color: rgba(255,255,255,0.88);
    }
    .moon-tooltip.gold-tooltip::before {
      content: '';
      position: absolute; top: 0; left: 12px; right: 12px; height: 1px;
      background: linear-gradient(to right, transparent, rgba(201,168,76,0.5), transparent);
    }
    .moon-tooltip.gold-tooltip::after { border-top-color: #12211f; }

    /* ══════════════════════════════════════════
       CHANGE 3 — Table play button: same spring + ripple as sticky player
    ══════════════════════════════════════════ */
    .play-btn {
      display: inline-flex; align-items: center; justify-content: center;
      width: 32px; height: 32px;
      border-radius: 50%;
      background: var(--primary);
      border: none; cursor: pointer; color: #fff;
      flex-shrink: 0;
      box-shadow: 0 2px 8px rgba(36,100,93,.3);
      position: relative; overflow: hidden;
      transition: background 0.42s cubic-bezier(0.4,0,0.2,1),
                  box-shadow  0.15s ease;
    }
    .play-btn:hover { box-shadow: 0 4px 14px rgba(36,100,93,.45); }
    .play-btn.playing { background: #c0392b; box-shadow: 0 2px 10px rgba(192,57,43,0.40); }
    .play-btn svg { display: block; position: relative; z-index: 1; }
    /* Spring animation */
    @keyframes playBtnSpring {
      0%   { transform: scale(1); }
      28%  { transform: scale(0.78); }
      62%  { transform: scale(1.14); }
      84%  { transform: scale(0.94); }
      100% { transform: scale(1); }
    }
    .play-btn.springing { animation: playBtnSpring 0.48s cubic-bezier(0.34,1.56,0.64,1); }
    /* Ripple on table btn */
    .play-btn-ripple {
      position: absolute; border-radius: 50%;
      width: 32px; height: 32px; left: 0; top: 0;
      background: rgba(255,255,255,0.28);
      transform: scale(0); pointer-events: none;
      animation: spmRipple 0.55s ease-out forwards;
    }
    @keyframes spmRipple { to { transform: scale(2.6); opacity: 0; } }

    .td-audio { text-align: center; width: 36px; padding: 12px 4px 12px 8px; }
    .td-moon { text-align: center; width: 32px; padding: 12px 8px 12px 0; }
    .moon-icon svg { display: block; }

    /* ── MOBILE last-ten ── */
    .day-card-mobile.last-ten { background: var(--surface); }
    .day-card-mobile.last-ten.today { background: #0f2d5e !important; border-left-color: #3a7bd5; }
    [data-theme="dark"] .day-card-mobile.last-ten.today { background: #0a2040 !important; }
    .day-card-mobile.last-ten.today .dcm-dag,
    .day-card-mobile.last-ten.today .dcm-date,
    .day-card-mobile.last-ten.today .dcm-day-label { color: rgba(255,255,255,0.85) !important; }
    .day-card-mobile.last-ten.today .imam-chip { opacity: 0.95; }
    .day-card-mobile.last-ten.today .dcm-surahs { background: rgba(255,255,255,0.08); color: rgba(255,255,255,0.9); }
    .day-card-mobile.last-ten.today .dcm-surahs-label { color: rgba(255,255,255,0.5); }
    .day-card-mobile.last-ten.today .dcm-pages { background: rgba(255,255,255,0.12); color: rgba(255,255,255,0.7); }
    .day-card-mobile.last-ten.today .today-badge { background: #3a7bd5; }
    .day-card-mobile.last-ten.today .dcm-dag.today-day { color: #7eb8f7 !important; }

    /* ══════════════════════════════════════════
       STICKY BOTTOM PLAYER
    ══════════════════════════════════════════ */
    .sticky-player { position: fixed; bottom: 0; left: 0; right: 0; z-index: 9999; }
    .player-full { background: var(--player-bg); border-radius: 22px 22px 0 0; border-top: 1px solid var(--player-border); box-shadow: var(--player-shadow); padding: 10px 18px 10px; transform-origin: bottom center; transform: translateY(0) scaleY(1); opacity: 1; transition: transform 0.52s cubic-bezier(0.4,0,0.2,1), opacity 0.28s ease, box-shadow 0.52s ease, background 0.35s, border-color 0.35s; will-change: transform, opacity; pointer-events: none; }
    .sticky-player.visible .player-full { pointer-events: auto; }
    .sticky-player:not(.visible):not(.mini-mode) .player-full { transform: translateY(100%); opacity: 0; }
    .sticky-player.mini-mode .player-full { transform: translateY(55%) scaleY(0.08); opacity: 0; box-shadow: none; pointer-events: none; }
    .sticky-top-row { display: flex; align-items: center; gap: 8px; margin-bottom: 6px; min-width: 0; transform-origin: top center; transition: transform 0.32s cubic-bezier(0.4,0,0.2,1), opacity 0.20s ease; }
    .sticky-player.mini-mode .sticky-top-row { transform: translateY(-8px) scaleY(0.3); opacity: 0; }
    .sticky-day-badge { font-size: .68rem; color: var(--primary-dark); font-weight: 700; white-space: nowrap; flex-shrink: 0; transition: color 0.35s; }
    .sticky-day-sub { font-size: .6rem; color: var(--muted-2); font-weight: 400; white-space: nowrap; flex-shrink: 0; transition: color 0.35s; }
    .sticky-marquee-wrap { flex: 1; min-width: 0; overflow: hidden; position: relative; }
    .sticky-marquee-wrap.fading { mask-image: linear-gradient(to right, transparent 0%, black 8%, black 85%, transparent 100%); -webkit-mask-image: linear-gradient(to right, transparent 0%, black 8%, black 85%, transparent 100%); }
    .sticky-marquee-inner { display: inline-flex; white-space: nowrap; }
    .sticky-marquee-inner.scrolling { animation: marqueeScroll var(--marquee-dur, 18s) linear infinite; }
    .sticky-marquee-text { font-size: .68rem; color: var(--muted); padding-right: 48px; transition: color 0.35s; }
    @keyframes marqueeScroll { 0% { transform: translateX(0); } 100% { transform: translateX(-50%); } }
    .sticky-times { font-size: .68rem; color: var(--muted-2); font-variant-numeric: tabular-nums; white-space: nowrap; flex-shrink: 0; transition: color 0.35s; }
    .sticky-seek-row { display: flex; align-items: center; gap: 8px; margin-bottom: 8px; }

    .sticky-seek {
      flex: 1; height: 28px; display: flex; align-items: center;
      position: relative; cursor: grab; touch-action: none;
    }
    .sticky-seek.seeking { cursor: grabbing; }
    /* Track (unplayed) */
    .sticky-seek::before {
      content: ''; position: absolute; left: 0; right: 0; top: 50%;
      height: 3px; transform: translateY(-50%); border-radius: 999px;
      background: var(--seek-bg);
      transition: height 0.18s cubic-bezier(0.4,0,0.2,1), background 0.35s;
      pointer-events: none;
    }
    .sticky-seek:hover::before, .sticky-seek.seeking::before, .sticky-seek.bar-expanded::before { height: 5px; }
    /* Fill (played) */
    .sticky-seek-fill {
      position: absolute; left: 0; top: 50%; transform: translateY(-50%);
      height: 3px; border-radius: 999px;
      background: var(--seek-fill);
      width: 0%; pointer-events: none; z-index: 1;
      transition: height 0.18s cubic-bezier(0.4,0,0.2,1), background 0.35s;
    }
    .sticky-seek:hover .sticky-seek-fill,
    .sticky-seek.seeking .sticky-seek-fill,
    .sticky-seek.bar-expanded .sticky-seek-fill { height: 5px; }
    /* Scrubber dot — hidden at rest, round dot on hover/drag */
    .sticky-seek-thumb {
      position: absolute; top: 50%; left: 0%;
      width: 0px; height: 0px;
      border-radius: 50%;
      background: var(--scrubber-notch);
      box-shadow: 0 1px 4px rgba(0,0,0,0.25);
      transform: translate(-50%, -50%);
      pointer-events: none; touch-action: none; z-index: 3;
      transition: width  0.18s cubic-bezier(0.34,1.56,0.64,1),
                  height 0.18s cubic-bezier(0.34,1.56,0.64,1),
                  background 0.35s;
    }
    .sticky-seek:hover .sticky-seek-thumb,
    .sticky-seek.seeking .sticky-seek-thumb,
    .sticky-seek.bar-expanded .sticky-seek-thumb { width: 13px; height: 13px; }
    .sticky-seek-thumb.dragging { width: 13px !important; height: 13px !important; }
    .sticky-player.mini-mode .sticky-seek-thumb { width: 0 !important; height: 0 !important; }

    /* ══════════════════════════════════════════
       CHANGE 4 — Sticky player controls: bigger buttons, more spacing
    ══════════════════════════════════════════ */
    .sticky-controls {
      display: grid;
      grid-template-columns: 1fr auto 1fr;
      align-items: center;
      position: relative;
      transform-origin: bottom center;
      transition: transform 0.30s cubic-bezier(0.4,0,0.2,1), opacity 0.20s ease;
    }
    /* CHANGE 4: Left side with more gap from center */
    .sticky-ctrl-left  { display: flex; align-items: center; justify-content: flex-end; gap: 14px; padding-right: 20px; }
    /* CHANGE 4: Right side with more gap from center */
    .sticky-ctrl-right { display: flex; align-items: center; justify-content: flex-start; gap: 14px; padding-left: 20px; }

    .sticky-player.mini-mode .sticky-controls { transform: translateY(16px) scaleY(0.15); opacity: 0; }

    /* CHANGE 4: Bigger prev/next/mute — 40px touch target */
    .sticky-ctrl-btn {
      background: none; border: none; cursor: pointer;
      color: var(--primary-dark);
      width: 40px; height: 40px;
      display: flex; align-items: center; justify-content: center;
      border-radius: 50%;
      opacity: .75;
      transition: opacity 0.15s ease, transform 0.15s ease, color 0.35s, background 0.15s;
    }
    .sticky-ctrl-btn:hover { opacity: 1; transform: scale(1.12); background: var(--row-hover); }
    .sticky-ctrl-btn:disabled { opacity: .25; cursor: default; transform: none; background: none; }
    /* CHANGE 4: Icons inside ctrl buttons — 22px */
    .sticky-ctrl-btn svg { width: 22px; height: 22px; display: block; }

    /* ── Main play button — ALT C spring + ripple ── */
    .sticky-play-main {
      width: 48px; height: 48px;
      border-radius: 50%;
      background: var(--primary-dark);
      border: none; cursor: pointer; color: #fff;
      display: flex; align-items: center; justify-content: center;
      box-shadow: 0 2px 10px rgba(36,100,93,.35);
      position: relative; overflow: hidden;
      transition: background 0.42s cubic-bezier(0.4,0,0.2,1), box-shadow 0.42s ease;
    }
    .sticky-play-main:hover { box-shadow: 0 4px 20px rgba(36,100,93,.45); }
    .sticky-play-main.red { background: #c0392b; box-shadow: 0 2px 10px rgba(192,57,43,0.40); }
    .sticky-play-main.red:hover { box-shadow: 0 4px 20px rgba(192,57,43,.50); }

    @keyframes spmSpring {
      0%   { transform: scale(1); }
      28%  { transform: scale(0.80); }
      62%  { transform: scale(1.13); }
      84%  { transform: scale(0.95); }
      100% { transform: scale(1); }
    }
    .sticky-play-main.springing { animation: spmSpring 0.48s cubic-bezier(0.34,1.56,0.64,1); }

    .spm-ripple {
      position: absolute; border-radius: 50%;
      width: 48px; height: 48px; left: 0; top: 0;
      background: rgba(255,255,255,0.22);
      transform: scale(0); pointer-events: none;
      animation: spmRipple 0.55s ease-out forwards;
    }

    /* CHANGE 3: Play icon perfectly centered via absolute positioning */
    .spm-icon-wrap {
      position: relative;
      width: 22px; height: 22px;
      display: flex; align-items: center; justify-content: center;
    }
    .spm-icon-wrap svg {
      position: absolute;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      transition: opacity 0.26s cubic-bezier(0.4,0,0.2,1),
                  transform 0.26s cubic-bezier(0.4,0,0.2,1);
    }
    .spm-play  { opacity: 1; transform: translate(calc(-50% + 1px), -50%) scale(1) !important; }
    .spm-pause { opacity: 0; transform: translate(-50%, -50%) scale(0.45) !important; }

    .sticky-play-main.red .spm-play  { opacity: 0; transform: translate(calc(-50% + 1px), -50%) scale(0.45) !important; }
    .sticky-play-main.red .spm-pause { opacity: 1; transform: translate(-50%, -50%) scale(1) !important; }

    .player-mini { position: absolute; bottom: 0; left: 0; right: 0; display: flex; flex-direction: column; background: var(--mini-bg); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); border-radius: 18px 18px 0 0; border-top: 1px solid var(--player-border); box-shadow: 0 -4px 24px rgba(0,0,0,.10); overflow: hidden; transform: translateY(100%) scaleY(0.4); transform-origin: bottom center; opacity: 0; pointer-events: none; transition: transform 0.52s cubic-bezier(0.34,1.56,0.64,1), opacity 0.22s ease 0.06s, background 0.35s, border-color 0.35s; will-change: transform, opacity; }
    .sticky-player.mini-mode .player-mini { transform: translateY(0) scaleY(1); opacity: 1; pointer-events: auto; }
    .mini-bar-track { width: 100%; height: 22px; background: transparent; flex-shrink: 0; position: relative; display: flex; align-items: center; cursor: grab; touch-action: none; overflow: visible; }
    .mini-bar-track.seeking { cursor: grabbing; }
    .mini-bar-track::before { content: ''; position: absolute; left: 0; right: 0; top: 50%; transform: translateY(-50%); height: 3px; border-radius: 999px; background: var(--seek-bg); transition: height 0.18s cubic-bezier(0.4,0,0.2,1), background 0.35s; pointer-events: none; }
    .mini-bar-track:hover::before, .mini-bar-track.seeking::before, .mini-bar-track.bar-expanded::before { height: 5px; }
    .mini-bar-fill { position: absolute; left: 0; top: 50%; transform: translateY(-50%); height: 3px; width: 0%; border-radius: 999px; background: var(--seek-fill); pointer-events: none; z-index: 1; transition: height 0.18s cubic-bezier(0.4,0,0.2,1), background 0.35s; overflow: hidden; }
    .mini-bar-track:hover .mini-bar-fill, .mini-bar-track.seeking .mini-bar-fill, .mini-bar-track.bar-expanded .mini-bar-fill { height: 5px; }
    .mini-bar-fill::after { content: ''; position: absolute; top: 0; left: -60%; bottom: 0; width: 60%; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.22), transparent); animation: barShimmer 2.8s ease-in-out infinite; }
    @keyframes barShimmer { 0%{left:-60%} 65%{left:120%} 100%{left:120%} }
    #mini-thumb { position: absolute; top: 50%; left: 0%; width: 0px; height: 0px; border-radius: 50%; background: var(--scrubber-notch); box-shadow: 0 1px 4px rgba(0,0,0,0.25); transform: translate(-50%, -50%); pointer-events: none; z-index: 3; transition: width 0.18s cubic-bezier(0.34,1.56,0.64,1), height 0.18s cubic-bezier(0.34,1.56,0.64,1), background 0.35s; }
    .mini-bar-track:hover #mini-thumb, .mini-bar-track.seeking #mini-thumb, .mini-bar-track.bar-expanded #mini-thumb { width: 11px; height: 11px; }
    #mini-thumb.dragging { width: 11px !important; height: 11px !important; }
    .mini-text-row { display: flex; align-items: center; justify-content: space-between; padding: 6px 16px 9px; }
    .mini-name { font-size: .65rem; color: var(--primary-dark); font-weight: 600; transition: color 0.35s; }
    .mini-time { font-size: .65rem; color: var(--muted-2); font-variant-numeric: tabular-nums; transition: color 0.35s; }

    .sticky-mute-btn.muted { opacity: 1 !important; color: #e05555 !important; }

    /* ── FILTER ── */
    .filter-wrap { margin-bottom: 20px; display: flex; flex-direction: column; align-items: center; gap: 10px; }
    .filter-chips { display: flex; flex-wrap: wrap; gap: 8px; justify-content: center; }
    .filter-chip { display: inline-flex; align-items: center; gap: 6px; background: var(--chip-bg); border: 1.5px solid transparent; border-radius: 30px; padding: 5px 12px 5px 8px; box-shadow: var(--chip-shadow); font-size: .78rem; font-weight: 500; font-family: inherit; cursor: pointer; color: var(--text); transition: all 0.2s ease; }
    .filter-chip:hover { box-shadow: 0 3px 12px rgba(0,0,0,.18); transform: translateY(-1px); }
    .filter-chip.active { background: var(--primary-dark); color: #fff; border-color: var(--primary-dark); box-shadow: 0 4px 14px rgba(26,74,68,.3); }
    .filter-chip.active .filter-dot { border-color: rgba(255,255,255,.4) !important; }
    .filter-dot { width: 10px; height: 10px; border-radius: 50%; flex-shrink: 0; }
    @keyframes chipPulse { 0% { box-shadow: 0 0 0 0 var(--pulse-color, rgba(0,0,0,0.4)); } 50% { box-shadow: 0 0 0 10px rgba(0,0,0,0); } 100% { box-shadow: 0 0 0 0 rgba(0,0,0,0); } }
    .filter-chip.active { animation: chipPulse 2s ease-out infinite; }
    tbody tr.filtered-out { display: none; }
    .day-card-mobile.filtered-out { display: none; }

    @keyframes fadeUp { from { opacity: 0; transform: translateY(18px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

    footer { background: var(--footer-bg); text-align: center; padding: 24px 20px; color: rgba(255,255,255,.45); font-size: .8rem; letter-spacing: .05em; transition: background 0.35s; }
    footer strong { color: var(--gold); }

    @media (max-width: 640px) {
      header { padding: 20px 16px 18px; }
      main { padding: 24px 12px 60px; }
      .table-wrap { display: none; }
      .mobile-cards { display: block; }
      .filter-chips { flex-direction: row; flex-wrap: wrap; justify-content: flex-start; width: 100%; gap: 8px; }
      .filter-chip { justify-content: flex-start; border-radius: 30px; padding: 6px 12px 6px 8px; font-size: .8rem; flex: 0 1 auto; }
      .filter-wrap { align-items: flex-start; }
      .today-card-top { padding: 18px 20px 16px; }
      .today-card-body { padding: 14px 20px 16px; }
      .today-imam-name { font-size: 1.6rem; }
    }
  </style>
</head>
<body>

<header>
  <!-- EXACT IMAGE TOGGLE: wide pill, label inside, dark sphere thumb -->
  <button class="theme-toggle" id="theme-toggle" onclick="toggleTheme()" aria-label="Byt tema">
    <div class="ios-track" id="ios-track">
      <span class="ios-track-label" id="toggle-label">LJUST<br>LÄGE</span>
      <div class="ios-thumb" id="ios-thumb">
        <!-- Sun icon — shown in light mode -->
        <span class="ios-thumb-icon ios-thumb-sun">
          <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="4"/>
            <line x1="12" y1="2"  x2="12" y2="5"/>
            <line x1="12" y1="19" x2="12" y2="22"/>
            <line x1="4.22" y1="4.22"  x2="6.34" y2="6.34"/>
            <line x1="17.66" y1="17.66" x2="19.78" y2="19.78"/>
            <line x1="2"  y1="12" x2="5"  y2="12"/>
            <line x1="19" y1="12" x2="22" y2="12"/>
            <line x1="4.22" y1="19.78" x2="6.34" y2="17.66"/>
            <line x1="17.66" y1="6.34"  x2="19.78" y2="4.22"/>
          </svg>
        </span>
        <!-- Moon icon — shown in dark mode -->
        <span class="ios-thumb-icon ios-thumb-moon">
          <svg width="11" height="11" viewBox="0 0 24 24" fill="white" stroke="none">
            <path d="M12 3a9 9 0 1 0 9 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 0 1-4.4 2.26 5.403 5.403 0 0 1-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"/>
          </svg>
        </span>
      </div>
    </div>
  </button>
  <div class="ornament">
    <div class="orn-line l"></div><div class="orn-dot"></div>
    <div class="orn-diamond"></div><div class="orn-dot"></div>
    <div class="orn-line r"></div>
  </div>
  <h1>Tarawih Schema för<br>Kämpingehallen<br><span style="font-size:0.65em;letter-spacing:0.04em;opacity:0.85;">Ramadan 2026</span></h1>
  <div class="header-address">
    <div class="addr-text">
      <svg xmlns="http://www.w3.org/2000/svg" width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg>
      Tenstastråket 16, 163 61 Spånga
    </div>
    <a href="https://www.google.com/maps/search/?api=1&query=Tenstastråket+16,+163+61+Spånga" target="_blank">
      <svg xmlns="http://www.w3.org/2000/svg" width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg>
      Hitta hit
    </a>
  </div>
</header>

<!-- CHANGE 1: Backdrop for mobile moon tooltip -->
<div class="moon-tooltip-backdrop" id="moon-tooltip-backdrop"></div>

<div class="wave">
  <svg viewBox="0 0 1440 56" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none">
    <path id="wave-path" d="M0,28 C400,65 1040,-9 1440,28 L1440,0 L0,0 Z" fill="#24645d"/>
  </svg>
</div>

<main>

  <!-- EID CARD -->
  <div class="eid-card" id="eid-card">
    <div class="eid-crescents">
      <span class="eid-crescent" style="left:8%;top:18%;--dur:7s;--delay:0s;--rot:-12deg;--max-op:0.15;">🌙</span>
      <span class="eid-crescent" style="right:10%;top:12%;--dur:9s;--delay:1.2s;--rot:10deg;--max-op:0.12;">🌙</span>
      <span class="eid-crescent" style="left:20%;bottom:20%;--dur:8s;--delay:2.5s;--rot:5deg;--max-op:0.10;">✦</span>
      <span class="eid-crescent" style="right:18%;bottom:25%;--dur:6.5s;--delay:0.8s;--rot:-8deg;--max-op:0.13;">✦</span>
      <span class="eid-crescent" style="left:50%;top:8%;--dur:10s;--delay:3s;--rot:3deg;--max-op:0.09;">🌙</span>
    </div>
    <div class="eid-inner">
      <div class="eid-ornament">
        <div class="eid-orn-line"></div><div class="eid-orn-dot"></div>
        <div class="eid-orn-diamond"></div><div class="eid-orn-dot"></div>
        <div class="eid-orn-line r"></div>
      </div>
      <div class="eid-arabic">تَقَبَّلَ اللهُ مِنَّا وَمِنْكُم</div>
      <div class="eid-title">Eid Mubarak</div>
      <div class="eid-divider">
        <div class="eid-divider-line"></div><div class="eid-divider-dot"></div><div class="eid-divider-line"></div>
      </div>
      <div class="eid-subtitle">Taqabbal Allahu minna wa minkum</div>
      <div class="eid-note">
        <strong>Ramadan 1447 är avslutat.</strong><br>
        Må Allah acceptera era böner, fasta och goda gärningar.<br>
        Vi ses nästa år, in shaa Allah.
      </div>
      <a class="eid-instagram" href="https://www.instagram.com/sverigesimamer/" target="_blank" rel="noopener">
        <svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"/><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"/><line x1="17.5" y1="6.5" x2="17.51" y2="6.5"/></svg>
        @sverigesimamer
      </a>
    </div>
  </div>

  <!-- TODAY CARD -->
  <div class="today-card" id="today-card">
    <div class="today-card-top">
      <div class="today-card-header-content">
        <div class="today-badge-pill">
          <div class="today-badge-pill-dot"></div>
          <span class="today-badge-pill-text">Dagens Imam</span>
        </div>
        <span class="today-imam-name" id="today-imam-name">—</span>
        <div class="today-date-row">
          <span class="today-date-text" id="today-date-label">—</span>
        </div>
      </div>
    </div>
    <div class="today-card-body">
      <div class="today-info-grid">
        <div class="today-info-cell">
          <span class="today-info-label">Sidor idag</span>
          <span class="today-info-value" id="today-pages">—</span>
        </div>
        <div class="today-info-cell">
          <span class="today-info-label">Suror</span>
          <span class="today-info-value" style="font-size:1rem; font-family:'DM Sans',sans-serif; font-weight:500;" id="today-surahs-name">—</span>
          <span class="today-info-sub" id="today-surahs-ref"></span>
        </div>
      </div>
      <div class="today-countdown-section" id="isha-countdown">
        <div class="today-countdown-inner">
          <div class="today-countdown-left">
            <span class="today-countdown-label" id="isha-label">Tid kvar till Isha</span>
            <div class="timer-wrap">
              <div class="today-timer" id="isha-timer">--:--:--</div>
              <div class="today-timer-done" id="isha-timer-done">🕌 Bönetiden är inne</div>
            </div>
            <span class="today-countdown-sub" id="isha-time-info"></span>
          </div>
          <button class="notif-btn" id="notif-btn" title="Få en notis när Isha-bönetiden börjar">
            <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/></svg>
            <span id="notif-btn-label">Notifiera mig</span>
          </button>
        </div>
      </div>
      <div class="today-card-footer">
        <button class="today-scroll-btn" onclick="scrollToToday()">
          <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"/></svg>
          Se i schemat
        </button>
      </div>
    </div>
  </div>

  <!-- SECTION TITLE -->
  <div class="section-title">
    <h2>Imamernas Böneledning</h2>
    <div class="divider"><span></span><i></i><span></span></div>
  </div>

  <!-- FILTER -->
  <div class="filter-wrap" id="filter-wrap">
    <div class="filter-chips" id="filter-chips">
      <button class="filter-chip" data-imam="abdurrahman" onclick="toggleFilter('abdurrahman')"><span class="filter-dot" style="background:var(--abdurrahman)"></span>Abdurrahman Sudani</button>
      <button class="filter-chip" data-imam="saed" onclick="toggleFilter('saed')"><span class="filter-dot" style="background:var(--saed);border:1px solid #bbb"></span>Saed Magan</button>
      <button class="filter-chip" data-imam="noor" onclick="toggleFilter('noor')"><span class="filter-dot" style="background:#ffffff;border:1px solid #bbb"></span>Noor</button>
      <button class="filter-chip" data-imam="abdul" onclick="toggleFilter('abdul')"><span class="filter-dot" style="background:var(--abdul)"></span>Abdul Qadir</button>
      <button class="filter-chip" data-imam="mohammed" onclick="toggleFilter('mohammed')"><span class="filter-dot" style="background:var(--mohammed)"></span>Mohammed Haji</button>
      <button class="filter-chip" data-imam="yacquub" onclick="toggleFilter('yacquub')"><span class="filter-dot" style="background:var(--yacquub)"></span>Yacquub</button>
      <button class="filter-chip" data-imam="ibrahim" onclick="toggleFilter('ibrahim')"><span class="filter-dot" style="background:var(--ibrahim)"></span>Ibrahim Noor</button>
      <button class="filter-chip" data-imam="abdelsalam" onclick="toggleFilter('abdelsalam')"><span class="filter-dot" style="background:var(--abdelsalam)"></span>Abdelsalam Nour</button>
      <button class="filter-chip" data-imam="hatem" onclick="toggleFilter('hatem')"><span class="filter-dot" style="background:var(--hatem)"></span>Hatem</button>
    </div>
  </div>

  <!-- DESKTOP TABLE -->
  <div class="table-wrap">
    <table>
      <thead>
        <tr>
          <th>#</th><th>Sidor</th><th>Suror</th><th>Imam</th><th>Datum</th><th></th><th></th><th>Dag</th>
        </tr>
      </thead>
      <tbody id="table-body"></tbody>
    </table>
  </div>

  <!-- MOBILE CARDS -->
  <div class="mobile-cards" id="mobile-cards"></div>

</main>

<footer>
  <a href="https://www.instagram.com/sverigesimamer/" target="_blank" rel="noopener" style="display:inline-flex;align-items:center;gap:7px;color:rgba(255,255,255,.65);text-decoration:none;margin-bottom:12px;font-size:.82rem;transition:color 0.2s;" onmouseover="this.style.color='#fff'" onmouseout="this.style.color='rgba(255,255,255,.65)'">
    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"/><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"/><line x1="17.5" y1="6.5" x2="17.51" y2="6.5"/></svg>
    @sverigesimamer
  </a>
  <br>
  &copy; 2026 &nbsp;<strong>Sveriges Imamer</strong>&nbsp; — Tarawih Schema Ramadan 1447
</footer>

<script>
  const SCHEDULE = [
    {day:1,  sidor:'2–11',    imam:'abdurrahman', imamLabel:'Abdurrahman Sudani', datum:'2026-02-17', vecka:'Tisdag',   surahs:'Al-Baqarah',                                                                                                        tooltip:'2:1 – 2:74'},
    {day:2,  sidor:'11–21',  imam:'saed',        imamLabel:'Saed Magan',         datum:'2026-02-18', vecka:'Onsdag',   surahs:'Al-Baqarah',                                                                                                        tooltip:'2:75 – 2:141'},
    {day:3,  sidor:'22–31',  imam:'noor',        imamLabel:'Noor',               datum:'2026-02-19', vecka:'Torsdag',  surahs:'Al-Baqarah',                                                                                                        tooltip:'2:142 – 2:202'},
    {day:4,  sidor:'32–41',  imam:'abdul',       imamLabel:'Abdul Qadir',        datum:'2026-02-20', vecka:'Fredag',   surahs:'Al-Baqarah',                                                                                                        tooltip:'2:203 – 2:265'},
    {day:5,  sidor:'42–51',  imam:'mohammed',    imamLabel:'Mohammed Haji',      datum:'2026-02-21', vecka:'Lördag',   surahs:'Al-Baqarah, Ali Imran',                                                                                             tooltip:'2:266 – 3:14'},
    {day:6,  sidor:'51–62',  imam:'abdurrahman', imamLabel:'Abdurrahman Sudani', datum:'2026-02-22', vecka:'Söndag',   surahs:'Ali Imran',                                                                                                         tooltip:'3:15 – 3:92'},
    {day:7,  sidor:'62–72',  imam:'abdurrahman', imamLabel:'Abdurrahman Sudani', datum:'2026-02-23', vecka:'Måndag',   surahs:'Ali Imran',                                                                                                         tooltip:'3:93 – 3:170'},
    {day:8,  sidor:'72–81',  imam:'saed',        imamLabel:'Saed Magan',         datum:'2026-02-24', vecka:'Tisdag',   surahs:'Ali Imran, An-Nisa',                                                                                                tooltip:'3:171 – 4:23'},
    {day:9,  sidor:'82–92',  imam:'ibrahim',     imamLabel:'Ibrahim Noor',        datum:'2026-02-25', vecka:'Onsdag',   surahs:'An-Nisa',                                                                                                           tooltip:'4:24 – 4:87'},
    {day:10, sidor:'92–101', imam:'ibrahim',      imamLabel:'Ibrahim Noor',        datum:'2026-02-26', vecka:'Torsdag',  surahs:'An-Nisa',                                                                                                           tooltip:'4:88 – 4:147'},
    {day:11, sidor:'102–106',imam:'mohammed',    imamLabel:'Mohammed Haji',      datum:'2026-02-27', vecka:'Fredag',   surahs:'An-Nisa, Fatir',                                                                                                    tooltip:'4:148 – 35:30'},
    {day:12, sidor:'438–449',imam:'saed',        imamLabel:'Saed Magan',         datum:'2026-02-28', vecka:'Lördag',   surahs:'Fatir, Ya-Sin',                                                                                                     tooltip:'35:31 – 36:82'},
    {day:13, sidor:'449–458',imam:'abdelsalam',  imamLabel:'Abdelsalam Nour',    datum:'2026-03-01', vecka:'Söndag',   surahs:'Ya-Sin, As-Saffat, Sad',                                                                                            tooltip:'36:83 – 38:88'},
    {day:14, sidor:'458–467',imam:'saed',        imamLabel:'Saed Magan',         datum:'2026-03-02', vecka:'Måndag',   surahs:'Az-Zumar',                                                                                                          tooltip:'39:1 – 39:75'},
    {day:15, sidor:'467–476',imam:'noor',        imamLabel:'Noor',               datum:'2026-03-03', vecka:'Tisdag',   surahs:'Ghafir',                                                                                                            tooltip:'40:1 – 40:85'},
    {day:16, sidor:'476–486',imam:'mohammed',    imamLabel:'Mohammed Haji',      datum:'2026-03-04', vecka:'Onsdag',   surahs:'Fussilat, Ash-Shura',                                                                                               tooltip:'41:1 – 42:26'},
    {day:17, sidor:'486–495',imam:'saed',        imamLabel:'Saed Magan',         datum:'2026-03-05', vecka:'Torsdag',  surahs:'Ash-Shura, Az-Zukhruf',                                                                                             tooltip:'42:27 – 43:89'},
    {day:18, sidor:'496–506',imam:'saed',        imamLabel:'Saed Magan',         datum:'2026-03-06', vecka:'Fredag',   surahs:'Ad-Dukhan, Al-Jathiyah, Al-Ahqaf',                                                                                  tooltip:'44:1 – 46:35'},
    {day:19, sidor:'507–515',imam:'yacquub',     imamLabel:'Yacquub',            datum:'2026-03-07', vecka:'Lördag',   surahs:'Muhammad, Al-Fath',                                                                                                 tooltip:'47:1 – 48:29'},
    {day:20, sidor:'515–523',imam:'yacquub',     imamLabel:'Yacquub',            datum:'2026-03-08', vecka:'Söndag',   surahs:'Al-Hujurat, Qaf, Adh-Dhariyat',                                                                                     tooltip:'49:1 – 51:60', moonText:'Profeten ﷺ sade: "Sök Laylat al-Qadr i de udda nätterna under de sista tio dagarna av Ramadan." (Sahih Bukhari)'},
    {day:21, sidor:'523–531',imam:'noor',        imamLabel:'Noor',               datum:'2026-03-09', vecka:'Måndag',   surahs:'At-Tur, An-Najm, Al-Qamar',                                                                                         tooltip:'52:1 – 54:55'},
    {day:22, sidor:'531–539',imam:'mohammed',    imamLabel:'Mohammed Haji',      datum:'2026-03-10', vecka:'Tisdag',   surahs:'Ar-Rahman, Al-Waqiah, Al-Hadid',                                                                                    tooltip:'55:1 – 57:15', moonText:'Profeten ﷺ sade: "Sök Laylat al-Qadr i de udda nätterna under de sista tio dagarna av Ramadan." (Sahih Bukhari)'},
    {day:23, sidor:'539–548',imam:'abdurrahman', imamLabel:'Abdurrahman Sudani', datum:'2026-03-11', vecka:'Onsdag',   surahs:'Al-Hadid, Al-Mujadilah, Al-Hashr',                                                                                  tooltip:'57:16 – 59:24'},
    {day:24, sidor:'549–557',imam:'abdul',       imamLabel:'Abdul Qadir',        datum:'2026-03-12', vecka:'Torsdag',  surahs:'Al-Mumtahanah, As-Saf, Al-Jumuah, Al-Munafiqun, At-Taghabun',                                                       tooltip:'60:1 – 64:18', moonText:'Profeten ﷺ sade: "Sök efter den (Maktens natt) på den tjugonionde, tjugosjunde och tjugofemte natten." Sahih al-Bukhari 2023'},
    {day:25, sidor:'558–566',imam:'hatem',       imamLabel:'Hatem',              datum:'2026-03-13', vecka:'Fredag',   surahs:'At-Talaq, At-Tahrim, Al-Mulk, Al-Qalam',                                                                            tooltip:'65:1 – 68:52'},
    {day:26, sidor:'566–574',imam:'abdurrahman', imamLabel:'Abdurrahman Sudani', datum:'2026-03-14', vecka:'Lördag',   surahs:'Al-Haqqah, Al-Maarij, Nuh, Al-Jinn, Al-Muzzammil',                                                                  tooltip:'69:1 – 73:20', moonText:'Profeten ﷺ sade: "Den som står upp i nattbön under Laylatul-Qadr med tro och i hopp om belöning får sina tidigare synder förlåtna." (al-Bukhari och Muslim)'},
    {day:27, sidor:'575–583',imam:'noor',        imamLabel:'Noor',               datum:'2026-03-15', vecka:'Söndag',   surahs:'Al-Muddaththir, Al-Qiyamah, Al-Insan, Al-Mursalat, An-Naba',                                                         tooltip:'74:1 – 78:40'},
    {day:28, sidor:'583–591',imam:'mohammed',    imamLabel:'Mohammed Haji',      datum:'2026-03-16', vecka:'Måndag',   surahs:'An-Naziat, Abasa, At-Takwir, Al-Infitar, Al-Mutaffifin, Al-Inshiqaq, Al-Buruj, At-Tariq, Al-Ala',                    tooltip:'79:1 – 87:19', moonText:'Profeten ﷺ sade: "Sök efter den (Maktens natt) på den tjugonionde, tjugosjunde och tjugofemte natten." Sahih al-Bukhari 2023'},
    {day:29, sidor:'592–604',imam:'yacquub',     imamLabel:'Yacquub',            datum:'2026-03-17', vecka:'Tisdag',   surahs:'Al-Ghashiyah, Al-Fajr, Al-Balad, Ash-Shams, Al-Layl, Ad-Duha, Ash-Sharh, At-Tin, Al-Alaq, Al-Qadr, Al-Bayyinah, Az-Zalzalah, Al-Adiyat, Al-Qariah, At-Takathur, Al-Asr, Al-Humazah, Al-Fil, Quraysh, Al-Maun, Al-Kawthar, Al-Kafirun, An-Nasr, Al-Masad, Al-Ikhlas, Al-Falaq, An-Nas', tooltip:'88:1 – 114:6'},
    {day:30, sidor:'2–11',   imam:'noor',        imamLabel:'Noor',               datum:'2026-03-18', vecka:'Onsdag',   surahs:'Al-Baqarah',                                                                                                        tooltip:'2:1 – 2:74'},
  ];

  const DAYS   = ['Söndag','Måndag','Tisdag','Onsdag','Torsdag','Fredag','Lördag'];
  const MONTHS = ['januari','februari','mars','april','maj','juni','juli','augusti','september','oktober','november','december'];
  const _now = new Date();
  const _p2 = n => String(n).padStart(2,'0');
  const today = _now.getFullYear() + '-' + _p2(_now.getMonth()+1) + '-' + _p2(_now.getDate());
  const isAfterRamadan = today > '2026-03-18';

  function scrollToToday() {
    const isMobile = window.innerWidth <= 640;
    const el = document.getElementById(isMobile ? 'today-row-mobile' : 'today-row-desktop');
    if (!el) return;
    const y = el.getBoundingClientRect().top + window.scrollY - 80;
    window.scrollTo({ top: y, behavior: 'smooth' });
  }

  /* ══════════════════════════════════════════
     CHANGE 1: Mobile moon tooltip — full-screen slide-up
  ══════════════════════════════════════════ */
  const backdrop = document.getElementById('moon-tooltip-backdrop');
  let _activeMoonEl = null;

  function isMobile() { return window.innerWidth <= 640; }

  function openMoonTooltip(wrapEl) {
    if (!isMobile()) return;
    closeMoonTooltip(false);
    const tip = wrapEl.querySelector('.moon-tooltip, .today-moon-tooltip');
    if (!tip) return;
    _activeMoonEl = { wrap: wrapEl, tip };
    backdrop.classList.add('visible');
    backdrop.classList.remove('hiding');
    tip.classList.add('visible');
    tip.classList.remove('hiding');
  }

  function closeMoonTooltip(animate = true) {
    if (!_activeMoonEl) return;
    const { tip } = _activeMoonEl;
    if (animate) {
      tip.classList.add('hiding');
      backdrop.classList.add('hiding');
      backdrop.classList.remove('visible');
      tip.addEventListener('animationend', () => {
        tip.classList.remove('visible', 'hiding');
      }, { once: true });
      backdrop.addEventListener('animationend', () => {
        backdrop.classList.remove('hiding');
      }, { once: true });
    } else {
      tip.classList.remove('visible', 'hiding');
      backdrop.classList.remove('visible', 'hiding');
    }
    // remove active from wrap
    document.querySelectorAll('.moon-wrap.active, .today-moon-wrap.active').forEach(el => el.classList.remove('active'));
    _activeMoonEl = null;
  }

  backdrop.addEventListener('click', () => closeMoonTooltip(true));

  document.addEventListener('click', (e) => {
    if (!e.target.closest('.surah-cell') && !e.target.closest('.dcm-surahs'))
      document.querySelectorAll('.tooltip-box.visible, .dcm-tooltip.visible').forEach(el => el.classList.remove('visible'));

    const moonWrap = e.target.closest('.moon-wrap, .today-moon-wrap');
    if (moonWrap) {
      if (isMobile()) {
        openMoonTooltip(moonWrap);
      } else {
        const isActive = moonWrap.classList.contains('active');
        document.querySelectorAll('.moon-wrap.active, .today-moon-wrap.active').forEach(el => el.classList.remove('active'));
        if (!isActive) moonWrap.classList.add('active');
      }
      e.stopPropagation();
      return;
    }

    // Close moon tooltips on outside click (desktop)
    if (!e.target.closest('.moon-wrap') && !e.target.closest('.today-moon-wrap')) {
      document.querySelectorAll('.moon-wrap.active, .today-moon-wrap.active').forEach(el => el.classList.remove('active'));
      if (isMobile()) closeMoonTooltip(true);
    }
  });

  // Build desktop table
  const tbody = document.getElementById('table-body');
  SCHEDULE.forEach(row => {
    const isToday = row.datum === today;
    const tr = document.createElement('tr');
    if (isToday) { tr.classList.add('today'); tr.id = 'today-row-desktop'; }
    const veckaClass = row.vecka === 'Fredag' ? 'fredag' : row.vecka === 'Lördag' ? 'lordag' : row.vecka === 'Söndag' ? 'sondag' : '';
    const badge = isToday ? '<span class="today-badge">Idag</span>' : '';
    const isLastTen = row.day >= 21;
    if (isLastTen) tr.classList.add('last-ten');
    const isOddNight = row.day % 2 !== 0;
    const moonClass = isOddNight ? 'moon-icon moon-odd' : 'moon-icon';
    const defaultMoonText = 'Profeten ﷺ sade: "Den som står upp i nattbön under Laylatul-Qadr med tro och i hopp om belöning får sina tidigare synder förlåtna." [al-Bukhari och Muslim]';
    const thisMoonText = row.moonText || defaultMoonText;
    const moonFill = isOddNight ? '#fff2c0' : 'white';
    const tooltipClass = isOddNight ? 'moon-tooltip gold-tooltip' : 'moon-tooltip';
    const moonIcon = isLastTen ? `<span class="moon-wrap"><span class="${moonClass}"><svg width="12" height="12" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 3a9 9 0 1 0 9 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 0 1-4.4 2.26 5.403 5.403 0 0 1-3.14-9.8c-.44-.06-.9-.1-1.36-.1z" fill="${moonFill}"/></svg></span><span class="${tooltipClass}"><span class="moon-tooltip-title">🌙 Laylatul-Qadr</span>${thisMoonText}</span></span>` : '';
    tr.innerHTML = `
      <td class="td-dag">${row.day}</td>
      <td class="td-sidor">${row.sidor}</td>
      <td class="td-surah surah-cell" tabindex="0">
        <div class="surah-names">${row.surahs}</div>
        <div class="tooltip-box">📖 ${row.tooltip}</div>
      </td>
      <td><span class="imam-chip imam-${row.imam}"><span class="dot"></span>${row.imamLabel}</span></td>
      <td class="td-datum ${isToday ? 'today-date' : ''}">${row.datum}${badge}</td>
      <td class="td-audio" id="audio-desktop-${row.datum}"></td>
      <td class="td-moon">${moonIcon}</td>
      <td class="td-veckodag ${veckaClass}">${row.vecka}</td>
    `;
    const cell = tr.querySelector('.surah-cell');
    cell.addEventListener('click', (e) => {
      const tip = cell.querySelector('.tooltip-box');
      const isVisible = tip.classList.contains('visible');
      document.querySelectorAll('.tooltip-box.visible').forEach(el => el.classList.remove('visible'));
      if (!isVisible) tip.classList.add('visible');
      e.stopPropagation();
    });
    tbody.appendChild(tr);
  });

  // Build mobile cards
  const container = document.getElementById('mobile-cards');
  SCHEDULE.forEach(row => {
    const isToday = row.datum === today;
    const card = document.createElement('div');
    const isLastTenM = row.day >= 21;
    card.className = 'day-card-mobile' + (isToday ? ' today' : '') + (isLastTenM ? ' last-ten' : '');
    if (isToday) card.id = 'today-row-mobile';
    const veckaClass = row.vecka === 'Fredag' ? 'fredag' : row.vecka === 'Lördag' ? 'lordag' : row.vecka === 'Söndag' ? 'sondag' : '';
    const badge = isToday ? '<span class="today-badge">Idag</span>' : '';
    const isOddNightM = row.day % 2 !== 0;
    const moonClassM = isOddNightM ? 'moon-icon moon-odd' : 'moon-icon';
    const defaultMoonTextM = 'Profeten ﷺ sade: "Den som står upp i nattbön under Laylatul-Qadr med tro och i hopp om belöning får sina tidigare synder förlåtna." [al-Bukhari och Muslim]';
    const thisMoonTextM = row.moonText || defaultMoonTextM;
    const moonFillM = isOddNightM ? '#fff2c0' : 'white';
    const tooltipClassM = isOddNightM ? 'moon-tooltip gold-tooltip' : 'moon-tooltip';
    const moonSpan = isLastTenM ? `<span class='moon-wrap' style='margin-left:5px;'><span class='${moonClassM}'><svg width='11' height='11' viewBox='0 0 24 24'><path d='M12 3a9 9 0 1 0 9 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 0 1-4.4 2.26 5.403 5.403 0 0 1-3.14-9.8c-.44-.06-.9-.1-1.36-.1z' fill='${moonFillM}'/></svg></span><span class='${tooltipClassM}' style='right:auto;left:0;'><span class="moon-tooltip-title">🌙 Laylatul-Qadr</span>${thisMoonTextM}</span></span>` : '';
    card.innerHTML = `
      <div class="dcm-top">
        <div class="dcm-dag ${isToday ? 'today-day' : ''}">${row.day}</div>
        <div class="dcm-body">
          <div class="dcm-imam"><span class="imam-chip imam-${row.imam}"><span class="dot"></span>${row.imamLabel}</span></div>
          <div class="dcm-meta">
            <span class="dcm-date">${row.datum}${badge}</span>
            ${moonSpan}
            <span class="dcm-day-label ${veckaClass}">${row.vecka}</span>
            <span class="dcm-pages">s. ${row.sidor}</span>
          </div>
        </div>
        <div class="dcm-audio-right" id="audio-mobile-${row.datum}"></div>
      </div>
      <div class="dcm-surahs">
        <span class="dcm-surahs-label">Suror — tryck för detaljer</span>
        ${row.surahs}
        <div class="dcm-tooltip">📖 ${row.tooltip}</div>
      </div>
    `;
    const surahBox = card.querySelector('.dcm-surahs');
    surahBox.addEventListener('click', (e) => {
      const tip = surahBox.querySelector('.dcm-tooltip');
      const isVisible = tip.classList.contains('visible');
      document.querySelectorAll('.dcm-tooltip.visible').forEach(el => el.classList.remove('visible'));
      if (!isVisible) {
        tip.classList.add('visible');
        setTimeout(() => { surahBox.scrollIntoView({ behavior: 'smooth', block: 'nearest' }); }, 220);
      }
      e.stopPropagation();
    });
    container.appendChild(card);
  });

  // Today card
  if (isAfterRamadan) document.getElementById('eid-card').style.display = 'block';

  const todayData = SCHEDULE.find(r => r.datum === today);
  if (todayData) {
    const d = new Date(today);
    document.getElementById('today-imam-name').textContent = todayData.imamLabel;
    const dateLabel = DAYS[d.getDay()] + ' ' + d.getDate() + ' ' + MONTHS[d.getMonth()];

    if (todayData.day >= 21) {
      const dateEl = document.getElementById('today-date-label');
      dateEl.textContent = dateLabel;
      const isTodayOdd = todayData.day % 2 !== 0;
      const todayMoonText = todayData.moonText || 'Profeten ﷺ sade: "Den som står upp i nattbön under Laylatul-Qadr med tro och i hopp om belöning får sina tidigare synder förlåtna." [al-Bukhari och Muslim]';
      const moonWrap = document.createElement('span');
      moonWrap.className = 'today-moon-wrap';
      moonWrap.style.marginLeft = '8px';
      const oddClass = isTodayOdd ? ' moon-odd-today' : '';
      const todayMoonFill = isTodayOdd ? '#fff2c0' : 'white';
      moonWrap.innerHTML = `<span class="today-moon-icon${oddClass}"><svg width="12" height="12" viewBox="0 0 24 24"><path d="M12 3a9 9 0 1 0 9 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 0 1-4.4 2.26 5.403 5.403 0 0 1-3.14-9.8c-.44-.06-.9-.1-1.36-.1z" fill="${todayMoonFill}"/></svg></span><span class="today-moon-tooltip"><span class="moon-tooltip-title">🌙 Laylatul-Qadr</span>${todayMoonText}</span>`;
      dateEl.parentNode.appendChild(moonWrap);

      const headerContent = document.querySelector('.today-card-header-content');
      const hadithDiv = document.createElement('div');
      hadithDiv.className = 'today-hadith-inline';
      hadithDiv.innerHTML = `<span class="hadith-label">🌙 Laylatul-Qadr</span>${todayMoonText}`;
      headerContent.appendChild(hadithDiv);
    } else {
      document.getElementById('today-date-label').textContent = dateLabel;
    }

    document.getElementById('today-pages').textContent = 'Sidor ' + todayData.sidor;
    document.getElementById('today-surahs-name').textContent = todayData.surahs;
    document.getElementById('today-surahs-ref').textContent = todayData.tooltip;

    const avatarPulseColors = {
      abdurrahman:'rgba(232,99,10,0.55)', saed:'rgba(212,168,0,0.55)', noor:'rgba(41,128,185,0.55)',
      abdul:'rgba(100,100,100,0.55)', mohammed:'rgba(33,145,80,0.55)', yacquub:'rgba(125,58,172,0.55)',
      ibrahim:'rgba(26,58,107,0.55)', abdelsalam:'rgba(123,63,0,0.55)', hatem:'rgba(45,106,79,0.55)',
    };
    const todayCard = document.getElementById('today-card');
    todayCard.style.display = 'block';
    todayCard.style.setProperty('--card-pulse', avatarPulseColors[todayData.imam] || 'rgba(255,255,255,0.3)');
    todayCard.classList.add('pulsing');

    let _hasScrolled = false;
    const _scrollGuard = () => { _hasScrolled = true; };
    window.addEventListener('scroll', _scrollGuard, { passive: true, once: true });
    setTimeout(() => {
      window.removeEventListener('scroll', _scrollGuard);
      if (_hasScrolled) return;
      const card = document.getElementById('today-card');
      const targetY = card.getBoundingClientRect().top + window.scrollY - 20;
      const startY = window.scrollY;
      const dist = targetY - startY;
      if (Math.abs(dist) < 10) return;
      const duration = 1100;
      let start = null;
      function easeInOutCubic(t) { return t < 0.5 ? 4*t*t*t : 1 - Math.pow(-2*t+2,3)/2; }
      function step(ts) {
        if (!start) start = ts;
        const elapsed = ts - start;
        const progress = Math.min(elapsed / duration, 1);
        window.scrollTo(0, startY + dist * easeInOutCubic(progress));
        if (progress < 1) requestAnimationFrame(step);
      }
      requestAnimationFrame(step);
    }, 3000);
  }

  // ── AUDIO ──
  const audioState = {};
  let _stickyScrollTimer = null;
  let _activeDatum = null;

  /* CHANGE 3 — reuse same spring+ripple for table play buttons */
  const PLAY_SVG  = `<svg width="13" height="13" viewBox="0 0 24 24" fill="currentColor" style="display:block;margin-left:1px"><polygon points="7,3 21,12 7,21"/></svg>`;
  const PAUSE_SVG = `<svg width="13" height="13" viewBox="0 0 24 24" fill="currentColor" style="display:block"><rect x="6" y="3" width="4" height="18"/><rect x="14" y="3" width="4" height="18"/></svg>`;
  const SPIN_SVG  = `<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" style="animation:spin 0.9s linear infinite;display:block"><path d="M12 2a10 10 0 1 0 10 10"/></svg>`;

  function triggerPlayBtnSpring(btn) {
    // Remove class, force reflow, re-add for restart
    btn.classList.remove('springing');
    void btn.offsetWidth;
    btn.classList.add('springing');
    btn.addEventListener('animationend', () => btn.classList.remove('springing'), { once: true });
    // Ripple
    const rip = document.createElement('span');
    rip.className = 'play-btn-ripple';
    btn.appendChild(rip);
    rip.addEventListener('animationend', () => rip.remove(), { once: true });
  }

  function updateStickyPlayBtn(isPlaying) {
    const btn = document.getElementById('sticky-play-btn');
    if (!btn) return;
    btn.classList.remove('springing');
    void btn.offsetWidth;
    btn.classList.add('springing');
    btn.addEventListener('animationend', () => btn.classList.remove('springing'), { once: true });
    const rip = document.createElement('span');
    rip.className = 'spm-ripple';
    btn.appendChild(rip);
    rip.addEventListener('animationend', () => rip.remove(), { once: true });
    if (isPlaying) { btn.classList.add('red'); }
    else           { btn.classList.remove('red'); }
  }

  function setBtns(datum, icon, isPlaying) {
    document.querySelectorAll('.play-btn[data-datum="' + datum + '"]').forEach(b => {
      b.innerHTML = icon;
      isPlaying ? b.classList.add('playing') : b.classList.remove('playing');
    });
    if (datum === _activeDatum) updateStickyPlayBtn(isPlaying);
  }

  function createPlayBtn(datum) {
    const btn = document.createElement('button');
    btn.className = 'play-btn';
    btn.setAttribute('data-datum', datum);
    btn.title = 'Spela upp recitation';
    btn.innerHTML = PLAY_SVG;
    btn.addEventListener('click', e => {
      e.stopPropagation();
      triggerPlayBtnSpring(btn);   // CHANGE 3: spring on table btn click
      toggleAudio(datum);
    });
    return btn;
  }

  function fmtTime(s) {
    if (!isFinite(s)) return '0:00';
    const m = Math.floor(s / 60);
    const sec = Math.floor(s % 60);
    return `${m}:${sec.toString().padStart(2,'0')}`;
  }

  function updatePlayerUI(datum, currentTime, duration) {
    const pct = duration > 0 ? (currentTime / duration) * 100 : 0;
    const cur   = document.getElementById('cur-desktop-'   + datum);
    const dur   = document.getElementById('dur-desktop-'   + datum);
    const fill  = document.getElementById('fill-desktop-'  + datum);
    const thumb = document.getElementById('thumb-desktop-' + datum);
    if (cur)   cur.textContent   = fmtTime(currentTime);
    if (dur)   dur.textContent   = fmtTime(duration);
    if (fill)  fill.style.width  = pct + '%';
    if (thumb) thumb.style.left  = pct + '%';
    const sCur   = document.getElementById('sticky-cur');
    const sDur   = document.getElementById('sticky-dur');
    const sFill  = document.getElementById('sticky-fill');
    const sThumb = document.getElementById('sticky-thumb');
    const mFill  = document.getElementById('mini-fill');
    const mThumb = document.getElementById('mini-thumb');
    if (sCur)   sCur.textContent   = fmtTime(currentTime);
    if (sDur)   sDur.textContent   = fmtTime(duration);
    if (sFill)  sFill.style.width  = pct + '%';
    if (sThumb) sThumb.style.left  = pct + '%';
    if (mFill)  mFill.style.width  = pct + '%';
    if (mThumb) mThumb.style.left  = pct + '%';
    const mTime = document.getElementById('mini-time-display');
    if (mTime) mTime.textContent = fmtTime(currentTime) + ' / ' + fmtTime(duration);
  }

  function showSticky() { if (!_activeDatum) return; const p = document.getElementById('sticky-player'); p.classList.add('visible'); p.classList.remove('mini-mode'); }
  function hideSticky() { const p = document.getElementById('sticky-player'); p.classList.remove('visible'); p.classList.remove('mini-mode'); }
  function miniSticky() { if (!_activeDatum) return; const p = document.getElementById('sticky-player'); p.classList.add('visible'); p.classList.add('mini-mode'); }

  window.addEventListener('scroll', () => {
    if (!_activeDatum) return;
    miniSticky();
    clearTimeout(_stickyScrollTimer);
    _stickyScrollTimer = setTimeout(showSticky, 600);
  }, { passive: true });

  function navigateTo(datum) {
    if (_activeDatum && audioState[_activeDatum]) { audioState[_activeDatum].pause(); setBtns(_activeDatum, PLAY_SVG, false); closePlayer(_activeDatum); }
    toggleAudio(datum);
  }

  function makeDraggableSeek(trackEl, thumbEl) {
    if (!trackEl) return;
    let _dragging = false;
    let _collapseTimer = null;
    const fillEl = trackEl.id === 'sticky-seek'
      ? document.getElementById('sticky-fill')
      : document.getElementById('mini-fill');

    function getPct(clientX) {
      const rect = trackEl.getBoundingClientRect();
      return Math.max(0, Math.min(1, (clientX - rect.left) / rect.width));
    }
    function applyPct(pct) {
      if (thumbEl) thumbEl.style.left = (pct * 100) + '%';
      const mt = trackEl.querySelector('#mini-thumb');
      if (mt) mt.style.left = (pct * 100) + '%';
      if (fillEl) fillEl.style.width = (pct * 100) + '%';
    }
    function expand() { clearTimeout(_collapseTimer); trackEl.classList.add('bar-expanded'); }
    function scheduleCollapse() {
      clearTimeout(_collapseTimer);
      _collapseTimer = setTimeout(() => { if (!_dragging) trackEl.classList.remove('bar-expanded'); }, 800);
    }
    function commitSeek(pct) {
      if (!_activeDatum || !audioState[_activeDatum]) return;
      const audio = audioState[_activeDatum];
      if (!audio.duration) return;
      audio._seekLock = true;
      audio.currentTime = pct * audio.duration;
      updatePlayerUI(_activeDatum, audio.currentTime, audio.duration);
      clearTimeout(audio._seekLockTimer);
      audio._seekLockTimer = setTimeout(() => { audio._seekLock = false; }, 300);
    }
    trackEl.addEventListener('pointerdown', e => {
      if (!_activeDatum || !audioState[_activeDatum]) return;
      const audio = audioState[_activeDatum];
      if (!audio.duration) return;
      _dragging = true; audio._seekLock = true;
      trackEl.setPointerCapture(e.pointerId);
      trackEl.classList.add('seeking');
      if (thumbEl) thumbEl.classList.add('dragging');
      expand(); applyPct(getPct(e.clientX));
      e.stopPropagation(); e.preventDefault();
    }, { passive: false });
    trackEl.addEventListener('pointermove', e => {
      if (!_dragging) return;
      const pct = getPct(e.clientX); applyPct(pct);
      if (_activeDatum && audioState[_activeDatum]?.duration) {
        const scrubTime = pct * audioState[_activeDatum].duration;
        const cur = document.getElementById('sticky-cur');
        const mTime = document.getElementById('mini-time-display');
        if (cur) cur.textContent = fmtTime(scrubTime);
        if (mTime) mTime.textContent = fmtTime(scrubTime) + ' / ' + fmtTime(audioState[_activeDatum].duration);
      }
      e.stopPropagation();
    });
    trackEl.addEventListener('pointerup', e => {
      if (!_dragging) return;
      _dragging = false; trackEl.classList.remove('seeking');
      if (thumbEl) thumbEl.classList.remove('dragging');
      trackEl.releasePointerCapture(e.pointerId);
      commitSeek(getPct(e.clientX)); scheduleCollapse();
      e.stopPropagation();
    });
    trackEl.addEventListener('pointercancel', () => {
      _dragging = false; trackEl.classList.remove('seeking');
      if (thumbEl) thumbEl.classList.remove('dragging'); scheduleCollapse();
    });
    trackEl.addEventListener('pointerleave', () => { if (!_dragging) scheduleCollapse(); });
    trackEl.addEventListener('pointerenter', () => { expand(); });
  }

  document.addEventListener('DOMContentLoaded', function() {
    const seekEl  = document.getElementById('sticky-seek');
    const thumbEl = document.getElementById('sticky-thumb');
    makeDraggableSeek(seekEl, thumbEl);
    const miniTrack = document.querySelector('.mini-bar-track');
    const miniThumb = document.getElementById('mini-thumb');
    if (miniTrack) makeDraggableSeek(miniTrack, miniThumb);

    const muteBtn = document.getElementById('sticky-mute');
    if (muteBtn) muteBtn.addEventListener('click', e => {
      const isMuted = muteBtn.classList.toggle('muted');
      Object.values(audioState).forEach(a => { a.muted = isMuted; });
      window._globalMuted = isMuted;
      document.getElementById('mute-icon-on').style.display  = isMuted ? 'none' : '';
      document.getElementById('mute-icon-off').style.display = isMuted ? ''     : 'none';
      muteBtn.style.opacity = isMuted ? '1' : '';
      e.stopPropagation();
    });

    const playBtn = document.getElementById('sticky-play-btn');
    if (playBtn) playBtn.addEventListener('click', e => { if (!_activeDatum) return; toggleAudio(_activeDatum); e.stopPropagation(); });
    const prevBtn = document.getElementById('sticky-prev');
    if (prevBtn) prevBtn.addEventListener('click', e => {
      if (!_activeDatum) return;
      const idx = SCHEDULE.findIndex(r => r.datum === _activeDatum);
      if (idx > 0 && audioUrls[SCHEDULE[idx-1].datum]) navigateTo(SCHEDULE[idx-1].datum);
      e.stopPropagation();
    });
    const nextBtn = document.getElementById('sticky-next');
    if (nextBtn) nextBtn.addEventListener('click', e => {
      if (!_activeDatum) return;
      const idx = SCHEDULE.findIndex(r => r.datum === _activeDatum);
      if (idx < SCHEDULE.length-1 && audioUrls[SCHEDULE[idx+1].datum]) navigateTo(SCHEDULE[idx+1].datum);
      e.stopPropagation();
    });
  });

  function updateStickyMarquee(row) {
    const wrap  = document.getElementById('sticky-marquee-wrap');
    const inner = document.getElementById('sticky-marquee-inner');
    const text1 = document.getElementById('sticky-marquee-text');
    const text2 = document.getElementById('sticky-marquee-text2');
    if (!wrap || !inner || !text1 || !text2) return;
    const txt = row.surahs + '  ·  ' + row.tooltip;
    text1.textContent = txt; text2.textContent = txt;
    text2.style.display = 'none';
    inner.classList.remove('scrolling'); inner.style.removeProperty('--marquee-dur'); wrap.classList.remove('fading');
    const ruler = document.createElement('span');
    ruler.style.cssText = 'position:fixed;top:-9999px;left:-9999px;white-space:nowrap;font-size:.68rem;visibility:hidden;pointer-events:none;';
    ruler.textContent = txt; document.body.appendChild(ruler);
    const playerEl = document.getElementById('sticky-player');
    const playerW = playerEl ? playerEl.getBoundingClientRect().width : window.innerWidth;
    const imamEl  = document.getElementById('sticky-imam-label');
    const dayEl   = document.getElementById('sticky-day-label');
    const timesEl = document.querySelector('.sticky-times');
    const imamW   = imamEl  ? imamEl.getBoundingClientRect().width  : 80;
    const dayW    = dayEl   ? dayEl.getBoundingClientRect().width   : 80;
    const timesW  = timesEl ? timesEl.getBoundingClientRect().width : 80;
    const gaps    = 8 * 3 + 32;
    const availW  = Math.max(60, playerW - imamW - dayW - timesW - gaps);
    const textW = ruler.getBoundingClientRect().width;
    document.body.removeChild(ruler);
    if (textW > availW) {
      text2.style.display = '';
      wrap.classList.add('fading');
      const totalW = textW + 48;
      const dur = Math.max(8, Math.round(totalW / 65));
      inner.style.setProperty('--marquee-dur', dur + 's');
      inner.classList.add('scrolling');
    }
  }

  function updateStickyControls() {
    if (!_activeDatum) return;
    const idx = SCHEDULE.findIndex(r => r.datum === _activeDatum);
    const prevBtn = document.getElementById('sticky-prev');
    const nextBtn = document.getElementById('sticky-next');
    const row = SCHEDULE[idx];
    if (prevBtn) prevBtn.disabled = idx <= 0 || !audioUrls[SCHEDULE[idx-1]?.datum];
    if (nextBtn) nextBtn.disabled = idx >= SCHEDULE.length-1 || !audioUrls[SCHEDULE[idx+1]?.datum];
    const imamEl  = document.getElementById('sticky-imam-label');
    const dayEl   = document.getElementById('sticky-day-label');
    const miniName = document.getElementById('mini-name-display');
    if (imamEl  && row) imamEl.textContent  = row.imamLabel;
    if (dayEl   && row) dayEl.textContent   = 'Natt ' + row.day + ' · ' + row.vecka;
    if (miniName && row) miniName.textContent = row.imamLabel + ' · Natt ' + row.day;
    if (row) updateStickyMarquee(row);
  }

  function openPlayer(datum) { _activeDatum = datum; updateStickyControls(); updateStickyPlayBtn(true); setTimeout(showSticky, 200); }
  function closePlayer(datum) { _activeDatum = null; hideSticky(); updateStickyPlayBtn(false); }

  function toggleAudio(datum) {
    Object.keys(audioState).forEach(d => {
      if (d !== datum && audioState[d] && !audioState[d].paused) { audioState[d].pause(); closePlayer(d); setBtns(d, PLAY_SVG, false); }
    });
    if (!audioState[datum]) {
      const a = new Audio();
      a.muted = !!window._globalMuted;
      a.src = audioUrls[datum];
      a.addEventListener('waiting',  () => setBtns(datum, SPIN_SVG, true));
      a.addEventListener('playing',  () => { setBtns(datum, PAUSE_SVG, true); openPlayer(datum); });
      a.addEventListener('timeupdate', () => { if (!a._seekLock) updatePlayerUI(datum, a.currentTime, a.duration); });
      a.addEventListener('loadedmetadata', () => updatePlayerUI(datum, a.currentTime, a.duration));
      a.addEventListener('ended', () => { closePlayer(datum); setBtns(datum, PLAY_SVG, false); updatePlayerUI(datum, 0, a.duration); });
      audioState[datum] = a;
    }
    const audio = audioState[datum];
    if (audio.paused) {
      setBtns(datum, SPIN_SVG, true);
      audio.play().then(() => {}).catch(err => { console.warn('Play failed:', err); setBtns(datum, PLAY_SVG, false); });
    } else {
      audio.pause();
      setBtns(datum, PLAY_SVG, false);
      updateStickyPlayBtn(false);
    }
  }

  function injectPlayButtons(datum) {
    ['audio-desktop-' + datum, 'audio-mobile-' + datum].forEach(id => {
      const cell = document.getElementById(id);
      if (cell && !cell.querySelector('.play-btn')) cell.appendChild(createPlayBtn(datum));
    });
  }

  const basePath = window.location.pathname.split('/').slice(0, -1).join('/');
  const audioUrls = {};
  SCHEDULE.forEach(row => {
    const url = basePath + '/' + row.datum + '.mp3';
    audioUrls[row.datum] = url;
    fetch(url, { method: 'HEAD' })
      .then(res => { if (res.ok || res.status === 206) injectPlayButtons(row.datum); })
      .catch(() => { fetch(url).then(res => { if (res.ok) injectPlayButtons(row.datum); }).catch(() => {}); });
  });

  // ── ISHA COUNTDOWN ──
  const ISHA_TIMES = {
    '2026-02-17':'18:56','2026-02-18':'18:58','2026-02-19':'19:00',
    '2026-02-20':'19:03','2026-02-21':'19:05','2026-02-22':'19:07',
    '2026-02-23':'19:10','2026-02-24':'19:12','2026-02-25':'19:14',
    '2026-02-26':'19:17','2026-02-27':'19:19','2026-02-28':'19:22',
    '2026-03-01':'19:24','2026-03-02':'19:27','2026-03-03':'19:29',
    '2026-03-04':'19:32','2026-03-05':'19:34','2026-03-06':'19:37',
    '2026-03-07':'19:39','2026-03-08':'19:42','2026-03-09':'19:45',
    '2026-03-10':'19:47','2026-03-11':'19:50','2026-03-12':'19:53',
    '2026-03-13':'19:55','2026-03-14':'19:58','2026-03-15':'20:01',
    '2026-03-16':'20:04','2026-03-17':'20:07','2026-03-18':'20:09',
  };

  function padZ(n) { return String(n).padStart(2,'0'); }
  function getDateKey(d) { const y=d.getFullYear(),m=padZ(d.getMonth()+1),day=padZ(d.getDate()); return y+'-'+m+'-'+day; }

  function startIshaCountdown() {
    const countdownEl  = document.getElementById('isha-countdown');
    const timerEl      = document.getElementById('isha-timer');
    const timerDoneEl  = document.getElementById('isha-timer-done');
    const infoEl       = document.getElementById('isha-time-info');
    const labelEl      = document.getElementById('isha-label');
    const notifBtn     = document.getElementById('notif-btn');
    const notifLabel   = document.getElementById('notif-btn-label');
    if (!countdownEl) return;
    countdownEl.style.display = 'block';

    let _hasTriggeredDone = false;

    function updateNotifBtn() {
      if (!('Notification' in window)) { notifBtn.style.display = 'none'; return; }
      if (Notification.permission === 'granted') { notifBtn.classList.add('granted'); notifLabel.textContent = 'Notis aktiv'; notifBtn.querySelector('svg').style.stroke = '#1d7a4e'; }
      else if (Notification.permission === 'denied') { notifBtn.classList.add('denied'); notifLabel.textContent = 'Notis blockerad'; }
    }
    updateNotifBtn();
    notifBtn.addEventListener('click', async () => {
      if (!('Notification' in window)) return;
      if (Notification.permission === 'default') { await Notification.requestPermission(); updateNotifBtn(); }
    });

    function fireIshaNotification(ishaStr) {
      if (!('Notification' in window) || Notification.permission !== 'granted') return;
      new Notification('🕌 Isha-bönen är inne', { body: 'Bönetiden har börjat — kl. ' + ishaStr, icon: '/favicon.ico', badge: '/favicon.ico', tag: 'isha-prayer', renotify: false, silent: false });
    }

    function triggerDoneAnimation(ishaStr) {
      if (_hasTriggeredDone) return;
      _hasTriggeredDone = true;
      timerEl.classList.add('fading-out');
      timerDoneEl.classList.add('fading-in');
      countdownEl.classList.add('isha-done');
      countdownEl.classList.add('isha-pulsing');
      countdownEl.addEventListener('animationend', () => { countdownEl.classList.remove('isha-pulsing'); }, { once: true });
      fireIshaNotification(ishaStr);
    }

    function tick() {
      const now = new Date();
      const todayKey = getDateKey(now);
      const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();
      const ishaStr = ISHA_TIMES[todayKey];
      if (!ishaStr) { timerEl.textContent = '--:--:--'; labelEl.textContent = 'Tid kvar till Isha'; infoEl.textContent = ''; return; }
      const [ishaH, ishaM] = ishaStr.split(':').map(Number);
      const ishaSec = ishaH * 3600 + ishaM * 60;
      if (nowSec >= ishaSec) {
        triggerDoneAnimation(ishaStr);
        labelEl.textContent = 'Isha';
        infoEl.textContent  = 'Isha-bönen är inne sedan kl. ' + ishaStr;
      } else {
        labelEl.textContent = 'Tid kvar till Isha';
        infoEl.textContent  = 'Isha-bönen börjar kl. ' + ishaStr;
        const diff = ishaSec - nowSec;
        const h = Math.floor(diff / 3600), m = Math.floor((diff % 3600) / 60), s = diff % 60;
        timerEl.textContent = padZ(h) + ':' + padZ(m) + ':' + padZ(s);
      }
    }
    tick();
    setInterval(tick, 1000);
  }
  startIshaCountdown();

  // ══════════════════════════════════════════
  // CHANGE 2 — iPhone toggle theme
  // ══════════════════════════════════════════
  const THEME_KEY = 'tarawih-theme';
  const _root = document.documentElement;

  function _applyTheme(theme) {
    _root.setAttribute('data-theme', theme);
    const label    = document.getElementById('toggle-label');
    const wavePath = document.getElementById('wave-path');
    if (theme === 'dark') {
      if (label)    label.innerHTML = 'MÖRKT<br>LÄGE';
      if (wavePath) wavePath.setAttribute('fill', '#131f1b');
    } else {
      if (label)    label.innerHTML = 'LJUST<br>LÄGE';
      if (wavePath) wavePath.setAttribute('fill', '#24645d');
    }
    localStorage.setItem(THEME_KEY, theme);
  }

  function toggleTheme() {
    const next = _root.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
    // Trigger thumb squish via a transient class
    const thumb = document.getElementById('ios-thumb');
    if (thumb) {
      thumb.style.transition = 'transform 0.36s cubic-bezier(0.34,1.56,0.64,1), width 0.10s ease';
    }
    _applyTheme(next);
  }

  (function() {
    const saved = localStorage.getItem(THEME_KEY);
    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    _applyTheme(saved || (prefersDark ? 'dark' : 'light'));
  })();

  window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
    if (!localStorage.getItem(THEME_KEY)) _applyTheme(e.matches ? 'dark' : 'light');
  });

  // ── FILTER ──
  let activeFilter = null;
  function toggleFilter(imam) {
    activeFilter = (activeFilter === imam) ? null : imam;
    applyFilter();
    if (activeFilter) {
      setTimeout(() => {
        const target = window.innerWidth <= 640 ? document.getElementById('mobile-cards') : document.querySelector('.table-wrap');
        if (target) { const y = target.getBoundingClientRect().top + window.scrollY - 90; window.scrollTo({ top: y, behavior: 'smooth' }); }
      }, 80);
    }
  }

  function applyFilter() {
    document.body.style.width = document.body.offsetWidth + 'px';
    document.body.style.overflowY = 'hidden';
    const imamColors = { abdurrahman:'rgba(232,99,10,0.5)', saed:'rgba(212,168,0,0.5)', noor:'rgba(41,128,185,0.5)', abdul:'rgba(44,44,44,0.5)', mohammed:'rgba(33,145,80,0.5)', yacquub:'rgba(125,58,172,0.5)', ibrahim:'rgba(26,58,107,0.5)', abdelsalam:'rgba(123,63,0,0.5)', hatem:'rgba(45,106,79,0.5)' };
    document.querySelectorAll('.filter-chip').forEach(btn => {
      const isActive = btn.dataset.imam === activeFilter;
      btn.classList.toggle('active', isActive);
      if (isActive) btn.style.setProperty('--pulse-color', imamColors[btn.dataset.imam] || 'rgba(0,0,0,0.3)');
      else btn.style.removeProperty('--pulse-color');
    });
    document.querySelectorAll('#table-body tr').forEach(tr => {
      const chip = tr.querySelector('.imam-chip');
      const show = !activeFilter || (chip && chip.classList.contains('imam-' + activeFilter));
      tr.classList.toggle('filtered-out', !show);
    });
    document.querySelectorAll('#mobile-cards .day-card-mobile').forEach(card => {
      const chip = card.querySelector('.imam-chip');
      const show = !activeFilter || (chip && chip.classList.contains('imam-' + activeFilter));
      card.classList.toggle('filtered-out', !show);
    });
    const visibleRows  = [...document.querySelectorAll('#table-body tr:not(.filtered-out)')];
    const visibleCards = [...document.querySelectorAll('#mobile-cards .day-card-mobile:not(.filtered-out)')];
    const lastDelay = Math.max(
      visibleRows.length  ? (visibleRows.length  - 1) * 45 + 320 : 0,
      visibleCards.length ? (visibleCards.length - 1) * 55 + 320 : 0
    );
    visibleRows.forEach((tr, i) => {
      tr.style.opacity='0'; tr.style.transform='translateY(8px)'; tr.style.transition='opacity 0.3s ease,transform 0.3s ease';
      setTimeout(() => { tr.style.opacity='1'; tr.style.transform='translateY(0)'; setTimeout(() => { tr.style.transition='background .15s'; tr.style.opacity=''; tr.style.transform=''; }, 320); }, i*45);
    });
    visibleCards.forEach((card, i) => {
      card.style.opacity='0'; card.style.transform='translateY(10px)'; card.style.transition='opacity 0.3s ease,transform 0.3s ease';
      setTimeout(() => { card.style.opacity='1'; card.style.transform='translateY(0)'; setTimeout(() => { card.style.transition=''; card.style.opacity=''; card.style.transform=''; }, 320); }, i*55);
    });
    setTimeout(() => { document.body.style.width=''; document.body.style.overflowY=''; }, lastDelay + 50);
  }
</script>

<!-- STICKY BOTTOM PLAYER -->
<div class="sticky-player" id="sticky-player">
  <div class="player-full">
    <div class="sticky-top-row">
      <span class="sticky-day-badge" id="sticky-imam-label">–</span>
      <span class="sticky-day-sub" id="sticky-day-label"></span>
      <div class="sticky-marquee-wrap" id="sticky-marquee-wrap">
        <div class="sticky-marquee-inner" id="sticky-marquee-inner">
          <span class="sticky-marquee-text" id="sticky-marquee-text"></span>
          <span class="sticky-marquee-text" id="sticky-marquee-text2" aria-hidden="true"></span>
        </div>
      </div>
      <span class="sticky-times"><span id="sticky-cur">0:00</span> / <span id="sticky-dur">0:00</span></span>
    </div>
    <div class="sticky-seek-row">
      <div class="sticky-seek" id="sticky-seek">
        <div class="sticky-seek-fill" id="sticky-fill"></div>
        <div class="sticky-seek-thumb" id="sticky-thumb"></div>
      </div>
    </div>
    <!-- CHANGE 4: Bigger buttons, more spacing, same-size mute -->
    <div class="sticky-controls">
      <div class="sticky-ctrl-left">
        <button class="sticky-ctrl-btn" id="sticky-prev" title="Föregående dag">
          <svg viewBox="0 0 24 24" fill="currentColor"><path d="M6 6h2v12H6zm3.5 6 8.5 6V6z"/></svg>
        </button>
      </div>
      <button class="sticky-play-main" id="sticky-play-btn" aria-label="Spela/Pausa">
        <span class="spm-icon-wrap" aria-hidden="true">
          <svg class="spm-play" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <polygon points="7,3 21,12 7,21"/>
          </svg>
          <svg class="spm-pause" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <rect x="6" y="3" width="4" height="18" rx="1.5"/>
            <rect x="14" y="3" width="4" height="18" rx="1.5"/>
          </svg>
        </span>
      </button>
      <div class="sticky-ctrl-right">
        <button class="sticky-ctrl-btn" id="sticky-next" title="Nästa dag">
          <svg viewBox="0 0 24 24" fill="currentColor"><path d="M18 6h-2v12h2zm-3.5 6L6 6v12z"/></svg>
        </button>
        <button class="sticky-ctrl-btn sticky-mute-btn" id="sticky-mute" title="Ljud av/på">
          <svg id="mute-icon-on" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/>
            <path d="M15.54 8.46a5 5 0 0 1 0 7.07"/>
            <path d="M19.07 4.93a10 10 0 0 1 0 14.14"/>
          </svg>
          <svg id="mute-icon-off" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display:none;">
            <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/>
            <line x1="23" y1="9" x2="17" y2="15"/>
            <line x1="17" y1="9" x2="23" y2="15"/>
          </svg>
        </button>
      </div>
    </div>
  </div>
  <div class="player-mini">
    <div class="mini-bar-track">
      <div class="mini-bar-fill" id="mini-fill"></div>
      <div id="mini-thumb"></div>
    </div>
    <div class="mini-text-row">
      <span class="mini-name" id="mini-name-display">–</span>
      <span class="mini-time" id="mini-time-display">0:00 / 0:00</span>
    </div>
  </div>
</div>

</body>
</html>
